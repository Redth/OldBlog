<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Redth]]></title>
  <link href="http://redth.info/atom.xml" rel="self"/>
  <link href="http://redth.info/"/>
  <updated>2014-09-17T08:50:53-04:00</updated>
  <id>http://redth.info/</id>
  <author>
    <name><![CDATA[Jon]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[Smarter Xamarin Android Support v4 / v13 Packages]]></title>
    <link href="http://redth.info/smarter-android-support-v4-v13-packages"/>
    <updated>2014-09-17T00:00:00-04:00</updated>
    <id>http://redth.info/Smarter-Android.Support.v4.v13.Packages</id>
    <content type="html"><![CDATA[<p>If you&#8217;ve ever built an Android app, you&#8217;ve probably used the Android Support libraries.  Google created these as a way to enable developers to use new features on older Android versions.  The most common Support library is arguably <code>Support-v4</code>, however as older Android devices retire and newer versions of Android increase in market share, <code>Support-v13</code> is becoming more commonplace.</p>

<p><strong><em>Warning:</em></strong> This is going to be a bit geeky of a post.  If you don&#8217;t want to know the details, skip down to the <strong>TL;DR</strong> section for the need-to-know bits :)</p>

<!-- more -->


<blockquote><p><code>Support-v4</code> can be used all the way back to Android API Level 4 (Donut - 1.6), but <code>Support-v13</code> is only compatible back to API Level 13 (Honeycomb - 3.2).</p></blockquote>

<p>The challenge with these two support libraries is that they are mutually exclusive.  That is, you can&#8217;t have <code>Support-v4</code> and <code>Support-v13</code> referenced in the same app.</p>

<p>There&#8217;s a good reason for this though: <code>Support-v13</code> actually contains all the code and classes that you&#8217;d find in <code>Support-v4</code>, it just adds a bit more on top of them.  So, the answer is, just use <code>Support-v13</code> if you need to instead, right?  <em>If only it were that simple.</em></p>

<p><strong>Trouble in Paradise</strong></p>

<p>Since <code>Support-v4</code> is so prevalent in apps and provides so much to developers, a lot of third party libraries themselves reference it.  <em>Facebook</em>, and even <em>Google Play Services</em> both depend on <code>Support-v4</code>, for example.</p>

<blockquote><p>Usually 3rd party libraries choose to depend on <code>Support-v4</code> and not <code>Support-v13</code> so that they can be used in apps with older API levels.</p></blockquote>

<p>In the Xamarin world, these libraries (or bindings) are compiled to expect a reference to <code>Xamarin.Support.v4.dll</code>, and if you try and add <code>Xamarin.Support.v13</code> to your project, things blow up (since <code>Support-v13</code> already contains <code>Support-v4</code>).  This has proven to be painful for developers wanting to use the new <code>Support-v13</code> features, but also any 3rd party libraries which reference <code>Support-v4</code>.</p>

<p><strong>TypeForwardedTo the rescue!</strong></p>

<p>Luckily, fellow Components Team member <a href="https://twitter.com/mattleibow">Matthew</a> thought up a crafty solution to this issue.  There&#8217;s a somewhat little known <code>Assembly</code> level attribute called <a href="http://goo.gl/Whj7Cm">TypeForwardedTo</a>.  This nifty attribute allows you to forward an expected type declaration in a given assembly to an actual implementation of it which exists in another assembly.</p>

<p>So, what we&#8217;ve done is created a <code>Xamarin.Android.Support.v4.dll</code> assembly which contains nothing but <code>[assembly: TypeForwardedTo (..)]</code> declarations to forward all of the expected <code>Support-v4</code> types to <code>Xamarin.Android.Support.v13.dll</code> instead.</p>

<p>This means if you&#8217;re using a library which requires a reference to <code>Xamarin.Android.Support.v4.dll</code> (Let&#8217;s say Google Play Services for instance), you can swap in this &#8216;type-forwarded&#8217; assembly, and then add a reference to <code>Xamarin.Android.Support.v13.dll</code> as well.  Since <strong><em>v13</em></strong> contains all the implementation which <strong><em>v4</em></strong> has just forwarded to it (and then some), you can use the new <strong><em>v13</em></strong> fanciness in your app, while still satisfying the <strong><em>v4</em></strong> reference that 3rd party libraries are depending on!</p>

<p><strong>Sprinkle in some magic NuGet dust&#8230;</strong></p>

<p>This wouldn&#8217;t be nearly as fun if you had to worry about which <code>Xamarin.Android.Support.v4.dll</code> you needed to pick (the actual implementation, or the type-forwarded one).  Luckily, in addition to the <code>TypeForwardedTo</code> magic, we&#8217;re adding some NuGet pixie dust to the mix!</p>

<p>If you&#8217;re interested in the mechanics, this is essentially the new .nuspec file we&#8217;re using (You can skip ahead to the TL;DR section below otherwise):</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
</pre></td><td class='code'><pre><code class='xml'><span class='line'><span class="cp">&lt;?xml version=&quot;1.0&quot;?&gt;</span>
</span><span class='line'><span class="nt">&lt;package</span> <span class="nt">&gt;</span>
</span><span class='line'>  <span class="nt">&lt;metadata&gt;</span>
</span><span class='line'>    <span class="nt">&lt;id&gt;</span>Xamarin.Android.Support.v4<span class="nt">&lt;/id&gt;</span>
</span><span class='line'>    <span class="nt">&lt;title&gt;</span>Xamarin Support Library v4<span class="nt">&lt;/title&gt;</span>
</span><span class='line'>    <span class="nt">&lt;version&gt;</span>20.0.0.4<span class="nt">&lt;/version&gt;</span>
</span><span class='line'>
</span><span class='line'>  <span class="c">&lt;!-- Ommitted boring parts --&gt;</span>
</span><span class='line'>
</span><span class='line'>    <span class="nt">&lt;dependencies&gt;</span>
</span><span class='line'>      <span class="c">&lt;!-- Depend on v13 support nuget if targeting equal or higher than Android 3.2 --&gt;</span>
</span><span class='line'>      <span class="nt">&lt;group</span> <span class="na">targetFramework=</span><span class="s">&quot;MonoAndroid32&quot;</span><span class="nt">&gt;</span>
</span><span class='line'>        <span class="nt">&lt;dependency</span> <span class="na">id=</span><span class="s">&quot;Xamarin.Android.Support.v13&quot;</span> <span class="na">version=</span><span class="s">&quot;20.0.0.4&quot;</span> <span class="nt">/&gt;</span>
</span><span class='line'>      <span class="nt">&lt;/group&gt;</span>
</span><span class='line'>    <span class="nt">&lt;/dependencies&gt;</span>
</span><span class='line'>  <span class="nt">&lt;/metadata&gt;</span>
</span><span class='line'>  <span class="nt">&lt;files&gt;</span>
</span><span class='line'>    <span class="c">&lt;!-- Use Support v4 lib for anything up to Android 3.2 --&gt;</span>
</span><span class='line'>    <span class="nt">&lt;file</span> <span class="na">src=</span><span class="s">&quot;V4\Xamarin.Android.Support.v4.dll&quot;</span> <span class="na">target=</span><span class="s">&quot;lib\MonoAndroid10&quot;</span> <span class="nt">/&gt;</span>
</span><span class='line'>
</span><span class='line'>    <span class="c">&lt;!-- Use Support v4 typeforwarded (to v13 types) lib for anything equal or higher than Android 3.2 --&gt;</span>
</span><span class='line'>    <span class="nt">&lt;file</span> <span class="na">src=</span><span class="s">&quot;V4TypeForwarded\Xamarin.Android.Support.v4.dll&quot;</span> <span class="na">target=</span><span class="s">&quot;lib\MonoAndroid32&quot;</span> <span class="nt">/&gt;</span>
</span><span class='line'>  <span class="nt">&lt;/files&gt;</span>
</span><span class='line'><span class="nt">&lt;/package&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<p><strong>TL;DR - The need to know bits</strong></p>

<p>We&#8217;ve made some minor, but important changes to the <code>Xamarin.Android.Support.v4</code> NuGet package:</p>

<ol>
<li><p>If your app is targeting Android API Level 13 or higher (Honeycomb 3.2), you will automatically get the <code>Xamarin.Android.Support.v13</code> NuGet package as a dependency.</p></li>
<li><p>If your app is targeting Android API Level 13 or higher, you will also get the <strong><em>Type-Forwarded</em></strong> assembly version of <code>Xamarin.Android.Support.v4.dll</code> installed by the NuGet package.  This will work in conjunction with and forward all of its types to the <code>Xamarin.Android.Support.v13.dll</code> assembly that gets installed by the <strong><em>v13</em></strong> NuGet dependency.</p></li>
<li><p>If your app is targeting anything <strong><em>below</em></strong> API Level 13 (eg: Froyo, Gingerbread), you will get the good old <code>Xamarin.Android.Support.v4.dll</code> assembly that you&#8217;ve come to know and love!</p></li>
</ol>


<p>To be clear, yes, we have decided that if you are targeting API Level 13 or higher, and choose to use the Android Support library <strong><em>v4</em></strong>, you will actually be using <strong><em>v13</em></strong> instead.  We decided the very small size increase was well worth the much improved compatibility between your apps and 3rd party libraries.</p>

<p>You can use these new packages today!  We will be rolling out updates to our Components to achieve the same results in the near future!</p>

<p>Enjoy!</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Unifying Google Play Services]]></title>
    <link href="http://redth.info/unifying-google-play-services"/>
    <updated>2014-09-16T00:00:00-04:00</updated>
    <id>http://redth.info/Unifying-Google-Play-Services</id>
    <content type="html"><![CDATA[<p>Once upon a time, you may have noticed there were a lot of choices when it came to adding Google Play Services to your Xamarin.Android apps.</p>

<p><img src="http://redth.info/images/unifying-google-play-services/xamarin-google-play-services-components.png" alt="Google Play Services Chaos" /></p>

<!-- more -->


<p>This was always a bit confusing.  Which version should you use for your app?  Should you use the version for the highest API level you&#8217;re targeting, or the lowest one?  The answer wasn&#8217;t always clear.</p>

<p>I won&#8217;t go into great detail as to why we did this in the past, because the good news is, there have been improvements in more recent versions of Xamarin.Android which have allowed us to unify many of these packages into one!</p>

<p>Starting today, we have simplified Google Play Services bindings into the two following packages (both for NuGet and Component Store):</p>

<ul>
<li>Google Play Services (Froyo)</li>
<li>Google Play Services</li>
</ul>


<p>This mirrors exactly what Google releases to developers: a .jar file frozen in time for Froyo compatibility, and the new, frequently updated .jar file for Gingerbread and above.</p>

<p><strong>Which one do I use?</strong></p>

<p>As a general rule, you should almost always use Google Play Services, unless you have a special need to target Froyo, however given that Froyo is now only 0.7% of devices, you are most likely safe to drop support for it.</p>

<p><em>There is one caveat:</em> If you are targeting Gingerbread, there will be some classes in Google Play Services that you aren&#8217;t able to use while running on Gingerbread (eg: <a href="http://developer.android.com/reference/com/google/android/gms/maps/MapFragment.html">MapFragment</a>).  You should take care to avoid using these if you are running on an API Level they aren&#8217;t compatible with (<a href="http://developer.android.com/reference/com/google/android/gms/maps/MapFragment.html">Google has documented this</a>).  Luckily Google also provides <code>Support*</code> versions of these classes (eg: <a href="http://developer.android.com/reference/com/google/android/gms/maps/SupportMapFragment.html">SupportMapFragment</a>).</p>

<p><strong>Updated &amp; Disabled/Delisted Components/NuGets</strong></p>

<p>Finally, if you have referenced the <em>Google Play Services (ICS)</em> Component or NuGet, you should update it (it will now appear as simply <em>Google Play Services</em>).  This also means we have disabled and delisted the following Components and NuGet packages:</p>

<ul>
<li>Google Play Services (Gingerbread)</li>
<li>Google Play Services (JellyBean)</li>
<li>Google Play Services (KitKat)</li>
</ul>


<p>If you were using any of those packages, now is a good time to update them to use the new packages!</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Finding your Android app's MD5 or SHA1 Signature from your keystore]]></title>
    <link href="http://redth.info/android-keystore-signatures-md5-sha1"/>
    <updated>2014-06-20T00:00:00-04:00</updated>
    <id>http://redth.info/Android-Keystore-Signatures-MD5-SHA1</id>
    <content type="html"><![CDATA[<p><img style="float: right" src="http://redth.info/images/android-keystore-signatures-md5-sha1/keystore-grumpy-cat.jpg" /></p>

<p>If you&#8217;ve ever used Google Maps or Amazon App Services in your Android app, you&#8217;ve probably gone through the pain of having to find an MD5 or SHA1 signature to give to the service so they could generate an API Key for you.</p>

<p>If you haven&#8217;t been through this experience, let me assure you: It&#8217;s painful, tedious, and annoying.</p>

<!-- more -->


<p>First of all, you need to find out which .keystore file was used to sign your app.  This is probably different depending on if you&#8217;re running a debug build versus a signed build for the app store.</p>

<p>If you&#8217;re a <a href="http://xamarin.com/android">Xamarin.Android</a> user, you may not have even been aware that a <code>debug.keystore</code> file was created for you at some point and is used to sign all of your debug builds, so you can remain blissfully unaware that it exists, or where it even lives.</p>

<p>There&#8217;s a great article on the <a href="">Xamarin Docs Site: Finding your Keystore&#8217;s MD5 or SHA1 Signature</a> that shows you how to generate these values step by step.  Put aside 15 minutes to go through it though (and hey, I wrote the initial draft of the doc, it&#8217;s as short as Google allowed me to make it, I swear!).</p>

<h3>Enter, Android Signature Tool.</h3>

<p>If you&#8217;ve been to my blog, you probably know that I don&#8217;t like to complain about problems that I can&#8217;t offer a solution for, so today is your lucky day!</p>

<p><img src="http://redth.info/images/android-keystore-signatures-md5-sha1/android-signature-tool-screenshot.png" alt="Android Signature Tool Screenshot" /></p>

<p>I&#8217;ve created a little tool called <strong><em><a href="https://github.com/Redth/Android.Signature.Tool/">Android Signature Tool</a></em></strong> (yes, the creative juices were flowing with that one).  It&#8217;s a simply GUI app (with a GUI for both Mac and Windows) that aims to minimize the tears spent on getting MD5 and SHA1 signatures.</p>

<p>It&#8217;s very simple.  It will try and first find java&#8217;s <strong><em>keytool</em></strong> executable on your machine (which is needed to generate the signatures).  The default option is to try and find your Xamarin generated <strong><em>debug.keystore</em></strong> file for you, and spit out the MD5 and SHA1 signatures with the click of a button!  You can also specify your own .keystore file (for which you need to know the alias, storepass, and keypass you used when you created it).</p>

<p>Hopefully this tool makes your life just a little bit more simple.  Enjoy!</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[What are App Links?]]></title>
    <link href="http://redth.info/what-are-app-links"/>
    <updated>2014-05-08T00:00:00-04:00</updated>
    <id>http://redth.info/app-links</id>
    <content type="html"><![CDATA[<p><img style="float: right" src="http://redth.info/images/App-Links/App-Links.png" /></p>

<p>So there&#8217;s this new thing called App Links.  It&#8217;s backed by Facebook and some other big names, so you know it&#8217;s going to gain at least a bit of traction.  But the problem is, everyone seems to have a hard time figuring out what they actually are and do.  The video on AppLinks.org sort of helps, but it still left me confused, even after watching it a few times.</p>

<p>Here&#8217;s my attempt to explain what App Links are, why you would need or want them, and how they work.  A word of caution: this post is aimed at mobile app developers, so it may be a bit confusing if you&#8217;re not familiar with some of the concepts of mobile app development.</p>

<!-- more -->


<h3>Let&#8217;s find a problem to solve!</h3>

<p>App Links solves a problem that maybe not everyone has caught up to yet, or even knows is a problem, or will be a problem for them.  Right now, if you were building an app and wanted to link to a Book on Amazon from within your app, how would you do it?  You&#8217;d probably find the link to the book (let&#8217;s say <code>http://amzn.com/B007Q4OVHQ</code>) and simply open that URL in the web browser on the device.</p>

<p><img style="float: right" src="http://redth.info/images/App-Links/Why-Link-To-Websites-Instead-Of-Apps.jpg" /></p>

<p>Sending your user into the mobile browser to this page is fine, it works, and Amazon even displays it nicely in a Mobile friendly format for you.  But is this really the best you can do?  What if your user already has the Amazon app installed on their mobile device?  They&#8217;re already logged in to the app, so the friction of actually buying the book you linked to at this point is much lower than if you had sent them to the website where they may still have to login.  Besides, the native app is usually, generally a much better experience.  Can&#8217;t our users have nice things?</p>

<p>Why are we linking back out to the web?  The pieces are all there for a better experience, we just need to put them together!</p>

<h3>Technical Hurdles</h3>

<p>Ok, so I&#8217;ve convinced you, instead of opening the mobile web page for the web link (<code>http://amzn.com/B007Q4OVHQ</code>) it would be much better to open that content right in the native app on the device.  Let&#8217;s assume the Amazon iOS app has registered itself to handle the URL scheme <code>amazon://</code>.  Now, let&#8217;s also assume that it&#8217;s been designed to accept a URL in the format of something like this:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>amazon://content/item?id=B007Q4OVHQ</span></code></pre></td></tr></table></div></figure>


<p>So for the techies out there, when another app asks iOS to open this URL, since Amazon&#8217;s app is registered to handle <code>amazon://</code> type URLs, iOS will pass the entire URL into the Amazon app when it is launched, instead of trying to open this URL in the browser.  At this point, it&#8217;s up to Amazon&#8217;s app logic to figure out how this <strong>deep link</strong> is opened inside of the app.  Ultimately the app will be programmed to see that the user wants to open the details of an item with an <em>ID</em> of <em>B007Q4OVHQ</em></p>

<p>This all works fine today as is, and you can certainly do it (at least in theory, I have no idea if Amazon&#8217;s app actually supports deep linking like this).  But, how are you supposed to know all the details of the URL scheme Amazon uses within their own app?  They may not publish this information anywhere, and even if they do, once you implement it for Amazon, what happens when you want to do the same for ebay, and the next site, and the site after that?</p>

<p>You can see where I&#8217;m going with this.  The process would result in an exhaustive amount of code to handle each site on a case by case basis.  It would be a nightmare to implement, let alone maintain.</p>

<h3>App Links to the rescue!</h3>

<p>Here&#8217;s where the App Links standard shines.  The idea simply put is that a web link to content should be able to define how that content may be viewed within native apps, on mobile devices.</p>

<p>So, if Amazon were to add a bit of special HTML to the book&#8217;s web page (for http://amzn.com/B007Q4OVHQ), instead of trying to figure out how we should construct an <code>amazon://</code> link on iOS for that content, we would simply scan the content of the book&#8217;s page to see if Amazon has told us about any other way to link to this same page&#8217;s content in mobile apps on other devices.</p>

<p>Dropping down to a more technical level, this content is defined by using special <code>&lt;meta .. /&gt;</code> tags in the web page&#8217;s HTML.  For the iOS example we&#8217;ve been looking at, Amazon could add something like this to their HTML:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>&lt;head&gt;
</span><span class='line'>  &lt;meta property="al:ios:url" content="amazon://content/item?id=B007Q4OVHQ" /&gt;
</span><span class='line'>&lt;/head&gt;</span></code></pre></td></tr></table></div></figure>


<p>This would describe the exact URL to use for deep linking to the content from this web page in the Amazon iOS app.</p>

<h3>One more piece to the puzzle</h3>

<p>This is all great, except you may be wondering, how does a mobile device know about this special metadata in the web page&#8217;s HTML?  Well, it doesn&#8217;t, at least not by default.</p>

<p>The other big piece of the puzzle is getting apps to look for this metadata when they are going to navigate to a URL.  It&#8217;s not hard to do in practice, but this means <strong>every</strong> time you navigate to a URL in your app, you will need to check to see if that URL contains any App Link metadata.  I&#8217;ll leave the debate about how this is good or bad for another time.</p>

<p>On iOS, you would basically replace:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='csharp'><span class='line'><span class="n">UIApplication</span><span class="p">.</span><span class="n">SharedApplication</span><span class="p">.</span><span class="n">OpenURL</span><span class="p">(</span><span class="s">&quot;http://amzn.com/B007Q4OVHQ&quot;</span><span class="p">);</span>
</span></code></pre></td></tr></table></div></figure>


<p>With this:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='csharp'><span class='line'><span class="kt">var</span> <span class="n">result</span> <span class="p">=</span> <span class="k">await</span> <span class="n">Rivets</span><span class="p">.</span><span class="n">AppLinks</span><span class="p">.</span><span class="n">Navigator</span><span class="p">.</span><span class="n">Navigate</span><span class="p">(</span><span class="s">&quot;http://amzn.com/B007Q4OVHQ&quot;</span><span class="p">);</span>
</span></code></pre></td></tr></table></div></figure>


<p>What this does is instead of directly navigating to the URL, it loads the URL first, checks for App Link metadata, and if it finds it, navigates to the appropriate app URL instead of the web URL.</p>

<h3>App Links and C&#35;</h3>

<p>See what I did there? Obviously <code>Rivets.AppLinks.Navigator.Navigate(..)</code> is not part of the iOS SDK.</p>

<p>I&#8217;ve been working on a C# implementation for App Links called <a href="https://github.com/xamarin/Rivets">Rivets</a>.  If you have read anything about app Links so far, you&#8217;ll probably have heard of <a href="https://github.com/BoltsFramework/">Bolts</a> which is an implementation of App Links for iOS (obj-c) and Android (java) created by Facebook.  So, <em>Rivets</em> is the Xamarin Android, Xamarin iOS, Windows Phone (and hopefully Windows Store soon) equivalent of Bolts!</p>

<h3>Other Platforms <em>ahem, Android and Windows Phone</em></h3>

<p>The example we looked at was specifically about iOS, but make no mistake, Android and Windows Phone are along for the ride.  I won&#8217;t go over the entire specification here, you can <a href="http://applinks.org/documentation/">visit the documentation</a> for that, but basically each platform has its own specific metadata property tags.  So on Android you&#8217;d have something like:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='html'><span class='line'><span class="nt">&lt;metadata</span> <span class="na">property=</span><span class="s">&quot;al:android:url&quot;</span> <span class="na">content=</span><span class="s">&quot;amazon://content/item?id=B007Q4OVHQ&quot;</span> <span class="nt">/&gt;</span>
</span><span class='line'><span class="nt">&lt;metadata</span> <span class="na">property=</span><span class="s">&quot;al:android:package&quot;</span> <span class="na">content=</span><span class="s">&quot;com.amazon&quot;</span> <span class="nt">/&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<p>Windows Phone is included in the standard right now, but sadly Windows Store and Windows Universal are not.  I&#8217;ve already petitioned to have them supported, though there&#8217;s really nothing stopping us from adopting them as part of the standard as long as we are consistent on the keys used (eg: <code>al:windows_store:url</code> and <code>al:windows_universal:url</code>).</p>

<p>Finally, iOS actually has two other more specific targets: <code>iphone</code> and <code>ipad</code> (eg: <code>al:iphone:url</code>).  The idea being that you might have different URL schemes for iPad and iPhone apps.</p>

<h3>Fallback Plan</h3>

<p>You might be wondering what happens when you try to navigate to a page which you presume might have App Link metadata, but it does not, or it does not have it for the platform you&#8217;re currently on (Windows Phone apps are still not as common for instance).</p>

<p>The standard for App Links has this taken care of.  In the App Link metadata, a <strong><em>Fallback Url</em></strong> can be specified.  This way, if the device can&#8217;t find any links pertaining to the given device, it may still be able to find a Fallback URL specified by the App Link metadata.  In a worst case scenario, if no Fallback URL is found, you can simply load the original web link as you would have before App Links existed.  Simple.</p>

<h3>In a nutshell</h3>

<p>To recap (with an illustration below to help), App Links are simply a standard way for describing how the content in a web page can be viewed, or deep linked to within a mobile app.  It&#8217;s this standard way of describing such information that allows any app to discover how to deep link to content in any other app by knowing only the web URL for the content you&#8217;re interested in linking to.</p>

<p><img src="http://redth.info/images/App-Links/App-Links-Example-Flow.png" /></p>

<p>App Links are open source, accessible to everyone, and work across devices.  Will they change the world? I don&#8217;t know.  But I think they&#8217;re a pretty good way to solve a problem that we may not yet be aware of.</p>

<p>I&#8217;d encourage you to start adding App Links navigation to your apps today!</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Such Android API levels, much confuse. Wow.]]></title>
    <link href="http://redth.info/such-android-api-levels-much-confuse-wow"/>
    <updated>2014-04-29T00:00:00-04:00</updated>
    <id>http://redth.info/such-api-levels-much-confuse</id>
    <content type="html"><![CDATA[<p><img style="float: right" src="http://redth.info/images/Android-API-Levels/Doge-API-Level.png" /></p>

<p>I have been bitten more than once by the confusion of Android&#8217;s many API levels when building Xamarin.Android apps.  It gets even more complex when you start referencing other libraries that target different API levels.  Just the other day I had an <a href="https://github.com/Redth/AndHUD/issues/9">issue come up with AndHUD</a> where the resolution for a runtime error had nothing to do with the code itself.  I decided it was time to finally write this post.</p>

<p>As if it weren&#8217;t confusing enough, Google generally gives three names to every API level: an integer API Level number, a version number, and a delicious sounding dessert name.</p>

<p>For example, Gingerbread was version 2.3 or API Level 9 (also Gingerbread had 2.3.7 and API level 10 as an update).  Kit Kat is version 4.4, API level 19.  Luckily <a href="http://developer.android.com/guide/topics/manifest/uses-sdk-element.html">Google has published</a> the various versions in a table so you can figure out what is what.</p>

<p>When it comes to your Xamarin.Android apps, it&#8217;s important to be aware of all of the spots you can set API levels in your project settings.  In particular, there are three places of interest:</p>

<ol>
<li>Project Settings -> General -> Target Framework</li>
<li>Project Settings -> Android Application -> Minimum Android Version</li>
<li>Project Settings -> Android Application -> Target Android Version</li>
</ol>


<!-- More -->


<p><img src="http://redth.info/images/Android-API-Levels/Android-API-Levels-Project-Settings.png" alt="Project Settings Android version info" /></p>

<h3>1. Target Framework</h3>

<p>This setting is arguably the most important one.  The Target Framework basically tells the compiler what API&#8217;s are available to compile your app with, at <em>compile time</em>.  This setting really has no bearing on what API&#8217;s are actually available to your app to use on a device at runtime, but rather which API&#8217;s are <em>potentially</em> available.</p>

<p>In AndHUD, I wanted to be able to use <code>Android.Animation.ValueAnimator</code> (which is only available in API Level 11 and higher).  If I had written code using that class and set my Target Framework to anything below API Level 11, I would have seen a compiler error saying the class <code>ValueAnimator</code> could not be found.  Since I set the Target Framework to API Level 11, my code compiled with no issues.</p>

<p>Generally, you will want to set your Target Framework to be at least as high as the highest API Level required by any code in your app.</p>

<h3>2. Minimum Android Version</h3>

<p>This one&#8217;s pretty simple, it&#8217;s the lowest API level that your app will allow itself to be installed and run on.</p>

<p>Why would you want this to be different then the Target Framework?  Well, in AndHUD, I wanted to make the progress circle animate when it changed.  Since the <code>ValueAnimator</code> class was only available in API Level 11 or higher, I had to make a decision:  Did I want to only support devices running API Level 11 or higher, or did I want to downgrade the user experience for older devices that didn&#8217;t support this animation?</p>

<p>I chose to support devices running older API levels.  Since my Target Framework was set to API Level 11, I needed to set the <em>Minimum Android Version</em> to <em>API Level 9 (2.3 Gingerbread)</em>, so the app would be allowed to still run on API Levels 9 and 10.</p>

<p>What this means, is that you can compile your app to use any API&#8217;s available up until the Target Framework, but your app will still run on devices running with API levels as low as your Minimum Android Version.</p>

<p>This doesn&#8217;t magically allow you to use unsupported API&#8217;s at runtime on devices that do not support them.  This simply allows you to still run your app on a device that <em>might</em> not support some of the API&#8217;s your compiled app <em>may</em> be using.  At this point it&#8217;s up to you to ensure at runtime that you don&#8217;t use any API calls which aren&#8217;t supported on the version of Android the device is currently running.</p>

<h3>Downgrading Experience at runtime</h3>

<p>If your <em>Minimum Android Version</em> is lower than your <em>Target Framework</em>, there are probably some devices that your app will run on which do not support all the API calls you&#8217;ve used in your app.  In this situation you need to make decisions about how to downgrade your user experience when API&#8217;s are not supported on a device your app is running on.  This may be cosmetic, or it could mean making some features or functionality available only to devices with newer versions of Android.</p>

<p>Since I decided to allow AndHUD to work on devices with API levels lower than 11, yet I used <code>ValueAnimator</code> which isn&#8217;t available on those lower API Levels, I needed to make sure that at runtime, I didn&#8217;t try to use the <code>ValueAnimator</code> class when it was not available.</p>

<p>To detect your API Level at runtime, you can access the <code>Android.OS.Build.Version.SdkInt</code> property.  There are a number of constants to check this property against such as <code>Android.OS.BuildVersionCodes.Honeycomb</code>.  Here&#8217;s how I dealt with downgrading the user experience in AndHUD:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
</pre></td><td class='code'><pre><code class='csharp'><span class='line'><span class="c1">// Get the version of Android we&#39;re currently running under</span>
</span><span class='line'><span class="kt">var</span> <span class="n">version</span> <span class="p">=</span> <span class="n">Android</span><span class="p">.</span><span class="n">OS</span><span class="p">.</span><span class="n">Build</span><span class="p">.</span><span class="n">VERSION</span><span class="p">.</span><span class="n">SdkInt</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'><span class="c1">// Check to see if we&#39;re &gt;= API Level 11 (HoneyComb)</span>
</span><span class='line'><span class="k">if</span> <span class="p">(</span><span class="n">version</span> <span class="p">&gt;=</span> <span class="n">Android</span><span class="p">.</span><span class="n">OS</span><span class="p">.</span><span class="n">BuildVersionCodes</span><span class="p">.</span><span class="n">Honeycomb</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>
</span><span class='line'>  <span class="c1">// It&#39;s safe to use ValueAnimator</span>
</span><span class='line'>  <span class="kt">var</span> <span class="n">va</span> <span class="p">=</span> <span class="p">(</span><span class="n">Android</span><span class="p">.</span><span class="n">Animation</span><span class="p">.</span><span class="n">ValueAnimator</span><span class="p">)</span><span class="n">Android</span><span class="p">.</span><span class="n">Animation</span><span class="p">.</span><span class="n">ValueAnimator</span><span class="p">.</span><span class="n">OfInt</span> <span class="p">(</span><span class="n">progress</span><span class="p">,</span> <span class="n">newProgress</span><span class="p">)</span>
</span><span class='line'>              <span class="p">.</span><span class="n">SetDuration</span> <span class="p">(</span><span class="m">250</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'>  <span class="n">va</span><span class="p">.</span><span class="n">Update</span> <span class="p">+=</span> <span class="p">(</span><span class="n">sender</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="p">{</span>
</span><span class='line'>      <span class="kt">var</span> <span class="n">interimValue</span> <span class="p">=</span> <span class="p">(</span><span class="kt">int</span><span class="p">)</span><span class="n">e</span><span class="p">.</span><span class="n">Animation</span><span class="p">.</span><span class="n">AnimatedValue</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>      <span class="n">progress</span> <span class="p">=</span> <span class="n">interimValue</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>      <span class="n">Invalidate</span> <span class="p">();</span>
</span><span class='line'>  <span class="p">};</span>
</span><span class='line'>
</span><span class='line'>  <span class="n">va</span><span class="p">.</span><span class="n">Start</span> <span class="p">();</span>
</span><span class='line'><span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span><span class='line'>  <span class="c1">// Not safe to use ValueAnimator so let&#39;s just change the progress without an animation</span>
</span><span class='line'>  <span class="n">progress</span> <span class="p">=</span> <span class="n">newProgress</span><span class="p">;</span>
</span><span class='line'>  <span class="n">Invalidate</span> <span class="p">();</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>You can see the difference in the animation below.  To the left, we&#8217;re running <strong>&lt;</strong> API Level 11 without any animation to the progress circle as it advances.  To the right, we&#8217;re running on <strong>>=</strong> API Level 11 with smooth animating of the progress circle.</p>

<p> <img src="http://redth.info/images/Android-API-Levels/AndHUD-Animation.gif" alt="Animation Differences between older and newer API Levels" /></p>

<p>How you downgrade user experience on older API Levels at runtime is going to be different depending on what API&#8217;s you&#8217;re actually using.  There is no simple answer for this, you just need to use your best judgement.</p>

<h3>3. Target Android Version</h3>

<p>I left this one until the end for a reason.  It&#8217;s probably not something you need to change unless you know exactly why you need to change it.  My recommendation here is to leave this one set to <em>Automatic - use target framework version</em> which will automatically target the same version you picked for <strong>#1 Target Framework</strong>.</p>

<p>There are some edge cases you might need to set this property different, but I haven&#8217;t run across any myself yet.</p>

<h3>But wait, there&#8217;s more (complexity)</h3>

<p>Now that you understand the difference between Target and minimum Android version settings there&#8217;s one more curve ball to throw at you.</p>

<p>You may have noticed already that in Android Library projects, there&#8217;s only one place where you can change the Android version, and that&#8217;s <strong>#1 Target Framework</strong>.  This makes sense, since a library cannot run on its own, and should have no opinion of which minimum Android version an app that uses the library should target (that would be rude).</p>

<p>In the case of AndHUD, the actual AndHUD library is set to Target Framework API Level 11.  It&#8217;s generally good practice to make your Android library projects Target the minimum API level it needs to compile.</p>

<p>For library projects, this doesn&#8217;t mean you&#8217;re off the hook for checking Android versions at runtime, in fact, in a library that others are consuming, you should be extra careful about which API calls you use and whether or not they are supported at runtime.  Try to be a considerate library developer:  <strong><em>don&#8217;t crash other peoples&#8217; apps!</em></strong></p>

<p>It&#8217;s also <strong><em>very important</em></strong> to note that if you&#8217;re consuming an Android library in your Android application, your application&#8217;s Target framework must be set to as high, or higher than the Target Framework in the library project, or you will no doubt, run into errors just like in the AndHUD issue I referred to at the beginning of this post.</p>

<p>Hopefully that sheds a bit more light into how Android versions (API Levels) relate to your Xamarin.Android libraries and applications.</p>

<p>Good luck, and stay on the level!</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[iTunes Media HotKey Disabler]]></title>
    <link href="http://redth.info/itunes-media-hotkey-disabler"/>
    <updated>2013-11-27T00:00:00-05:00</updated>
    <id>http://redth.info/itunes-media-hotkey-disabler</id>
    <content type="html"><![CDATA[<p>This simple application will allow you to disable or enable iTunes from listening to when you press the media keys (Play / Pause) on your keyboard.  This is great for applications such as gTunes which make use of the hot keys but cannot themselves prevent iTunes from also responding to those keyboard keys.</p>

<p><img src="http://redth.info/images/itunes-media-hotkey-disabler/itunes-media-hotkey-disabler.png" alt="" /></p>

<!-- More -->


<ul>
<li><a href="https://googledrive.com/host/0B5rPKkNu1C2INC13ZEV5dGFmYk0/iTunes.Media.HotKey.Disabler.1.0.0.dmg">Download <strong>iTunes.Media.HotKey.Disabler.1.0.0.dmg</strong></a></li>
</ul>


<p><strong>Why create this app?</strong></p>

<p>While working on an upcoming Google Music app (gTunes) that&#8217;s currently waiting for approval on the app store, I wanted to make use of the media keys (Play/Pause, Next, Prev, etc.).  This was easily enough done, however there was one major issue.  Apple does not expose any API&#8217;s to prevent iTunes from opening when the Play/Pause keyboard button is pressed on a Mac.  There are ways around this, but to my limited Mac development knowledge, none of them would be allowed on the App Store.</p>

<p><strong>How does it work?</strong></p>

<p>The most consistent and easiest way I&#8217;ve found to stop iTunes from listening for the Play/Pause button key was to stop the Launch Agent <strong><em>com.apple.rcd</em></strong></p>

<p>If you&#8217;re more comfortable with Terminal, you can do the exact same thing that this app does with the command:</p>

<blockquote><p><code>launchctl unload -w /System/Library/LaunchAgents/com.apple.rcd.plist</code></p></blockquote>

<p>Similarly, the Launch agent can be re-enabled so that iTunes listens for the Play / Pause key again with the command:</p>

<blockquote><p><code>launchctl load -w /System/Library/LaunchAgents/com.apple.rcd.plist</code></p></blockquote>

<p><strong>More interesting things</strong></p>

<p>It&#8217;s worth noting I don&#8217;t know a lot yet about Mac development, but I&#8217;ve been able to create this app (and the upcoming gTunes) using <a href="http://xamarin.com/mac">Xamarin.Mac</a>, creating a fully native app all in C#!  You should check out <a href="http://xamarin.com/">Xamarin</a>!</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[iOS7: Fun times with the new Full Screen Layout!]]></title>
    <link href="http://redth.info/ios7-full-screen-layout"/>
    <updated>2013-09-26T00:00:00-04:00</updated>
    <id>http://redth.info/ios7-full-screen-layout</id>
    <content type="html"><![CDATA[<p>In a mad rush, I had to prepare an app for iOS7 <em>after</em> its release.  Yes, I know, shame on me for not listening to everyone telling me to start getting my apps ready early.  How bad could it be anyway?</p>

<p>For the most part, not too bad.  The worst part for me came in the shape of dealing with this new idea that every <code>UIViewController</code> now expands the bounds of the entire screen, including where the status bar and navigation bars could be.  In any case, I had to do a bit of learning really quickly.  If you don&#8217;t already know what I&#8217;m talking about, here&#8217;s a picture of one unpleasant conversion experience:</p>

<p><img src="http://redth.info/images/ios7-full-screen-layout/navigation-bar-overlapping.png" alt="" /></p>

<!-- more -->


<p>At this point, many thoughts went through my head.  I could just change the table view&#8217;s Frame right? Well then I would have to check if it&#8217;s iOS7 or not, and adjust according to iOS version, and and andâ€¦ that just doesn&#8217;t seem right.  Why would you do this to me, Apple?!  At this point I took a deep breath, relaxed, and did what any competent developer would do: I Googled it.</p>

<p>This of course led me to StackOverflow, and several people asking the same thing.  <a href="http://stackoverflow.com/questions/17074365/status-bar-and-navigation-bar-appear-over-my-views-bounds-in-ios-7">Why is my navigation bar and status bar appearing over my view?</a>.  There&#8217;s some pretty good answers there no doubt.</p>

<h3>Everything new is old again!</h3>

<p>Of course, the easiest way is just: make it work like it used to!  This is entirely possible!  All it requires really, is setting your view controller&#8217;s <code>EdgesForExtendedLayout</code> property to <code>UIRectEdge.None</code>.  This was a quick fix, and ended up getting me up and running again until I could figure things out (you can of course choose some, all, or none of the edges to be used for extended layout with this property - for example, you might want the top to blur under the navigation bar, but the bottom to not blur underneath the tabs).</p>

<p>This was a workable solution, but I still wasn&#8217;t really happy with it.  After all, the cool kids were all using the fancy blurred view scrolling behind the navigation and status bars like in the image below, and, who doesn&#8217;t want shiny and new?</p>

<p><img src="http://redth.info/images/ios7-full-screen-layout/blurred.png" alt="" /></p>

<h3>Newfangledness $#&amp;@*</h3>

<p>So, what Apple really intends is to get a nice blurring effect of the contents of a scrollable view that happen to be <em>under</em> navigation bars, status bars, tab bars, etc.  It&#8217;s really quite nice, if you haven&#8217;t seen it in action for yourself yet.</p>

<p>To make this happen, we essentially need to project our view to the bounds of the entire screen.  The problem with this of course, is that we don&#8217;t want the top parts of our scrollable view to be initially hidden behind the navigation and status bars.</p>

<h3>Content Insets to the rescue! (grab a coffee first)</h3>

<p>If our view fills up the entire bounds of the screen, yet there&#8217;s still a status bar and navigation bar to show over top of it, we need a way to make sure the contents of our view aren&#8217;t initially hidden by the navigation and status bars.</p>

<p>For this purpose, we can take advantage of the <code>ContentInset</code> property that exists on any kind of scrollable view (eg: <code>UITableView</code>, <code>UIWebView</code>, <code>UIScrollView</code>, etc).  This little gem of a property allows us to specify where our content should initially start, offset from the edges of the view that is holding it.</p>

<p>It&#8217;s important to note that Apple tries to help us out here.  By default the <code>UIViewController</code> property <code>AutomaticallyAdjustsScrollViewInsets</code> is set to <code>true</code>, which means that in many cases, this will just work, and you won&#8217;t have to think about it.  However, in practice you might run into some edge cases (haha, get it?) where the inset cannot automatically be inferred correctly, like I did.</p>

<p>In one case, my <code>UITableView</code> was not automatically adjusting the inset correctly.  Long story short, I had to account for a status bar (<strong>20pt</strong>), and a navigation bar (<strong>44pt</strong>) for a total of (<strong>64pt</strong>) inset from the top edge of the screen.  That meant I needed to set my <code>UITableView.ContentInset = new UIEdgeInsets (64, 0, 0, 0);</code>.  The result was my UITableView still taking up the entire screen, but not making the top row initially hidden behind the navigation bar, while still taking advantage of the nice blurred scrolling underneath of it.</p>

<h3>More dynamic?</h3>

<p>You may have scoffed at my example of hard-coding the inset.  All I can say is that sometimes you just need it to work immediately.  If you&#8217;d like to do this more properly, you should consider the other new properties Apple has included on the <code>UIViewController</code> which are: <code>TopLayoutGuide</code> and <code>BottomLayoutGuide</code>.  These serve as a reference  to us to let us know what the <em>top</em> (and <em>bottom</em>) of our content should be within the bounds of the screen (by using the <code>.Length</code> property of Top/Bottom layout guides).</p>

<p>Now, there is one catch.  As of this article being published, the <code>.Length</code> property was missing from the Xamarin API.  There&#8217;s already a bug in for a fix, and in the meantime there&#8217;s a work around:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='csharp'><span class='line'><span class="kt">var</span> <span class="n">length</span> <span class="p">=</span> <span class="n">MonoTouch</span><span class="p">.</span><span class="n">ObjCRuntime</span><span class="p">.</span><span class="n">Messaging</span><span class="p">.</span><span class="n">float_objc_msgSend</span> <span class="p">(</span><span class="n">TopLayoutGuide</span><span class="p">.</span><span class="n">Handle</span><span class="p">,</span> <span class="p">(</span><span class="k">new</span> <span class="n">Selector</span><span class="p">(</span><span class="s">&quot;length&quot;</span><span class="p">)).</span><span class="n">Handle</span><span class="p">);</span>
</span></code></pre></td></tr></table></div></figure>


<p>Oops, there&#8217;s another catch.  This property doesn&#8217;t seem to return > 0 until the views have all been laid out.  So, you may consider doing something like this:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class='csharp'><span class='line'><span class="k">public</span> <span class="k">override</span> <span class="k">void</span> <span class="nf">ViewDidLayoutSubviews</span> <span class="p">()</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>  <span class="k">base</span><span class="p">.</span><span class="n">ViewDidLayoutSubviews</span> <span class="p">();</span>
</span><span class='line'>
</span><span class='line'>   <span class="kt">var</span> <span class="n">length</span> <span class="p">=</span> <span class="n">MonoTouch</span><span class="p">.</span><span class="n">ObjCRuntime</span><span class="p">.</span><span class="n">Messaging</span><span class="p">.</span><span class="n">float_objc_msgSend</span> <span class="p">(</span>
</span><span class='line'>                 <span class="n">TopLayoutGuide</span><span class="p">.</span><span class="n">Handle</span><span class="p">,</span>
</span><span class='line'>                 <span class="p">(</span><span class="k">new</span> <span class="n">Selector</span><span class="p">(</span><span class="s">&quot;length&quot;</span><span class="p">)).</span><span class="n">Handle</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'>  <span class="n">TableView</span><span class="p">.</span><span class="n">ContentInset</span> <span class="p">=</span> <span class="k">new</span> <span class="n">UIEdgeInsets</span> <span class="p">(</span><span class="n">length</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">);</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<h3>Also, don&#8217;t get caught with your pants down!</h3>

<p>If you haven&#8217;t already guessed it, some of these properties are iOS7 only.  So if you&#8217;re targeting iOS6 still, you&#8217;ll have to do some sort of version checking to make sure you only use these API&#8217;s when the app is running under iOS7!</p>

<hr />

<p>Anyway, I hope this finds its way to someone else who is going through the same learning pain as I did, to get their app ready for iOS7!</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[iOS7 Recipe: Background Fetching]]></title>
    <link href="http://redth.info/ios7-recipe-background-fetching"/>
    <updated>2013-09-22T00:00:00-04:00</updated>
    <id>http://redth.info/ios7-recipe-background-fetching</id>
    <content type="html"><![CDATA[<p>This is my entry into the <a href="http://blog.xamarin.com/xamarin-recipe-cook-off/">Xamarin Recipe Cook-Off</a>.  Recipes, in Xamarin terms, are very simple demonstrations of how a single feature or piece of functionality is implemented.  I thought background fetching would be useful to many developers, and it&#8217;s pretty easy to implement, especially after reading this recipe.</p>

<ul>
<li><a href="https://github.com/Redth/iOS.BackgroundFetch.Sample">View the entire Recipe &amp; Source Code</a></li>
</ul>


<p>I&#8217;ve also included the recipe in this blog post:</p>

<h2>Background Fetching Data</h2>

<p>This recipe shows how to register your application to perform background fetching on intervals.</p>

<h4>1. Recipe</h4>

<p>In your application&#8217;s <code>Info.plist</code> file, add the value <code>fetch</code> to the <code>UIBackgroundModes</code> (<em>Required background modes</em>) property.</p>

<p>Next, in your <code>AppDelegate</code> class, in the <code>FinishedLaunching</code> override method, add the following code to register your application for background fetching:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='csharp'><span class='line'><span class="n">UIApplication</span><span class="p">.</span><span class="n">SharedApplication</span><span class="p">.</span><span class="n">SetMinimumBackgroundFetchInterval</span> <span class="p">(</span><span class="n">UIApplication</span><span class="p">.</span><span class="n">BackgroundFetchIntervalMinimum</span><span class="p">);</span>
</span></code></pre></td></tr></table></div></figure>


<p>Finally, in your <code>AppDelegate</code> class, override the <code>PerformFetch</code> method.</p>

<p>This method will be executed by the operating system when it sees best fit (eg: when the device is awake and connected already).  You do not have complete control over how often or when fetching happens.</p>

<p>You should execute your own code to fetch new data in this method.  It&#8217;s important to call the <code>Action&lt;UIBackgroundFetchResult&gt; completionHandler</code> parameter which is passed into this method with the appropriate result when you are done.</p>

<h4>2. Sample PerformFetch</h4>

<p>In this sample, a weather service is called by background fetching so that when the user opens the app, recent weather is available.  The weather is cached locally after it&#8217;s fetched in the background, and the UI is also updated if there is new weather info.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
</pre></td><td class='code'><pre><code class='csharp'><span class='line'><span class="k">public</span> <span class="k">override</span> <span class="k">async</span> <span class="k">void</span> <span class="nf">PerformFetch</span> <span class="p">(</span><span class="n">UIApplication</span> <span class="n">application</span><span class="p">,</span> <span class="n">Action</span><span class="p">&lt;</span><span class="n">UIBackgroundFetchResult</span><span class="p">&gt;</span> <span class="n">completionHandler</span><span class="p">)</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>  <span class="n">Console</span><span class="p">.</span><span class="n">WriteLine</span> <span class="p">(</span><span class="s">&quot;PerformFetch called...&quot;</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'>  <span class="c1">//Return no new data by default</span>
</span><span class='line'>  <span class="kt">var</span> <span class="n">result</span> <span class="p">=</span> <span class="n">UIBackgroundFetchResult</span><span class="p">.</span><span class="n">NoData</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">try</span>
</span><span class='line'>  <span class="p">{</span>
</span><span class='line'>    <span class="c1">//Get latest weather</span>
</span><span class='line'>    <span class="kt">var</span> <span class="n">w</span> <span class="p">=</span> <span class="k">await</span> <span class="n">GetWeatherAsync</span><span class="p">(</span><span class="s">&quot;Windsor, Canada&quot;</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">if</span> <span class="p">(</span><span class="n">w</span> <span class="p">!=</span> <span class="k">null</span><span class="p">)</span>
</span><span class='line'>    <span class="p">{</span>
</span><span class='line'>      <span class="c1">//Cache the weather locally</span>
</span><span class='line'>      <span class="n">CacheWeatherAsync</span><span class="p">(</span><span class="n">w</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'>      <span class="c1">//Update the UI</span>
</span><span class='line'>      <span class="n">weatherViewController</span><span class="p">.</span><span class="n">UpdateWeather</span><span class="p">(</span><span class="n">w</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'>      <span class="c1">//Indicate we have new data</span>
</span><span class='line'>      <span class="n">result</span> <span class="p">=</span> <span class="n">UIBackgroundFetchResult</span><span class="p">.</span><span class="n">NewData</span><span class="p">;</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'>  <span class="k">catch</span>
</span><span class='line'>  <span class="p">{</span>
</span><span class='line'>    <span class="c1">//Indicate a failed fetch if there was an exception</span>
</span><span class='line'>    <span class="n">result</span> <span class="p">=</span> <span class="n">UIBackgroundFetchResult</span><span class="p">.</span><span class="n">Failed</span><span class="p">;</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'>  <span class="k">finally</span>
</span><span class='line'>  <span class="p">{</span>
</span><span class='line'>    <span class="c1">//We really should call the completion handler with our result</span>
</span><span class='line'>    <span class="n">completionHandler</span> <span class="p">(</span><span class="n">result</span><span class="p">);</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<h4>3. Additional Information</h4>

<ul>
<li>Your <code>PerformFetch</code> has about <strong>30</strong> seconds to run before it&#8217;s killed</li>
<li>The operating system is more likely to grant more time (and more often) to your application for background fetching if you are efficient, which means executing quickly, and always calling <code>completionHandler</code> with an accurate result</li>
<li>You can tell the operating system  the minimum time to sleep between waking up your application and calling its <code>PerformFetch</code> method if you know your app only updates at a certain interval, to avoid extra calls to <code>PerformFetch</code> and wasting battery life.  You would specify the minimum time in seconds in the <code>UIApplication.SharedApplication.SetMinimumBackgroundFetchInterval (double minimumBackgroundFetchInterval)</code> method</li>
<li>You can actually make calls to update your UI from the <code>PerformFetch</code> method so that the next time the user launches the app, everything is up to date</li>
</ul>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[How to Auto Wire Up Android Activity Views in Xamarin.Android]]></title>
    <link href="http://redth.info/Auto-Wire-Up-Views-Xamarin-Activity"/>
    <updated>2013-07-23T00:00:00-04:00</updated>
    <id>http://redth.info/auto-wire-up-android-activity-views-xamarin</id>
    <content type="html"><![CDATA[<p>One thing that&#8217;s occasionally bothered me was how verbose it is in Android to wire up views from a layout, in an activity.  I finally was fed up enough to write a simple little helper that does this based on reflection.  Consider the following verbosity monstrosity:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
</pre></td><td class='code'><pre><code class='csharp'><span class='line'><span class="na">[Activity (Label = &quot;RandomDataActivity&quot;)]</span>            
</span><span class='line'><span class="k">public</span> <span class="k">class</span> <span class="nc">RandomDataActivity</span> <span class="p">:</span> <span class="n">Activity</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>  <span class="n">Button</span> <span class="n">button1</span><span class="p">;</span> <span class="n">Button</span> <span class="n">button2</span><span class="p">;</span> <span class="n">Button</span> <span class="n">button3</span><span class="p">;</span> <span class="n">Button</span> <span class="n">button4</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>  <span class="n">TextView</span> <span class="n">textView1</span><span class="p">;</span> <span class="n">TextView</span> <span class="n">textView2</span><span class="p">;</span> <span class="n">TextView</span> <span class="n">textView3</span><span class="p">;</span>
</span><span class='line'>  <span class="n">TextView</span> <span class="n">textView4</span><span class="p">;</span> <span class="n">TextView</span> <span class="n">textView5</span><span class="p">;</span> <span class="n">TextView</span> <span class="n">textView6</span><span class="p">;</span>
</span><span class='line'>  <span class="n">TextView</span> <span class="n">textView7</span><span class="p">;</span> <span class="n">TextView</span> <span class="n">textView8</span><span class="p">;</span> <span class="n">TextView</span> <span class="n">textView9</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>  <span class="n">ImageView</span> <span class="n">imageView1</span><span class="p">;</span> <span class="n">ImageView</span> <span class="n">imageView2</span><span class="p">;</span> <span class="n">ImageView</span> <span class="n">imageView3</span><span class="p">;</span>
</span><span class='line'>  <span class="n">ImageView</span> <span class="n">imageView4</span><span class="p">;</span> <span class="n">ImageView</span> <span class="n">imageView5</span><span class="p">;</span> <span class="n">ImageView</span> <span class="n">imageView6</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">protected</span> <span class="k">override</span> <span class="k">void</span> <span class="nf">OnCreate</span> <span class="p">(</span><span class="n">Bundle</span> <span class="n">bundle</span><span class="p">)</span>
</span><span class='line'>  <span class="p">{</span>
</span><span class='line'>      <span class="k">base</span><span class="p">.</span><span class="n">OnCreate</span> <span class="p">(</span><span class="n">bundle</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'>      <span class="n">SetContentView</span> <span class="p">(</span><span class="n">Resource</span><span class="p">.</span><span class="n">Layout</span><span class="p">.</span><span class="n">RandomDataLayout</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'>      <span class="n">button1</span> <span class="p">=</span> <span class="n">FindViewById</span><span class="p">&lt;</span><span class="n">Button</span><span class="p">&gt;(</span><span class="n">Resource</span><span class="p">.</span><span class="n">Id</span><span class="p">.</span><span class="n">button1</span><span class="p">);</span>
</span><span class='line'>      <span class="n">button2</span> <span class="p">=</span> <span class="n">FindViewById</span><span class="p">&lt;</span><span class="n">Button</span><span class="p">&gt;(</span><span class="n">Resource</span><span class="p">.</span><span class="n">Id</span><span class="p">.</span><span class="n">button2</span><span class="p">);</span>
</span><span class='line'>      <span class="n">button3</span> <span class="p">=</span> <span class="n">FindViewById</span><span class="p">&lt;</span><span class="n">Button</span><span class="p">&gt;(</span><span class="n">Resource</span><span class="p">.</span><span class="n">Id</span><span class="p">.</span><span class="n">button3</span><span class="p">);</span>
</span><span class='line'>      <span class="n">button4</span> <span class="p">=</span> <span class="n">FindViewById</span><span class="p">&lt;</span><span class="n">Button</span><span class="p">&gt;(</span><span class="n">Resource</span><span class="p">.</span><span class="n">Id</span><span class="p">.</span><span class="n">button4</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'>      <span class="n">textView1</span> <span class="p">=</span> <span class="n">FindViewById</span><span class="p">&lt;</span><span class="n">TextView</span><span class="p">&gt;(</span><span class="n">Resource</span><span class="p">.</span><span class="n">Id</span><span class="p">.</span><span class="n">textView1</span><span class="p">);</span>
</span><span class='line'>      <span class="n">textView2</span> <span class="p">=</span> <span class="n">FindViewById</span><span class="p">&lt;</span><span class="n">TextView</span><span class="p">&gt;(</span><span class="n">Resource</span><span class="p">.</span><span class="n">Id</span><span class="p">.</span><span class="n">textView2</span><span class="p">);</span>
</span><span class='line'>      <span class="n">textView3</span> <span class="p">=</span> <span class="n">FindViewById</span><span class="p">&lt;</span><span class="n">TextView</span><span class="p">&gt;(</span><span class="n">Resource</span><span class="p">.</span><span class="n">Id</span><span class="p">.</span><span class="n">textView3</span><span class="p">);</span>
</span><span class='line'>      <span class="n">textView4</span> <span class="p">=</span> <span class="n">FindViewById</span><span class="p">&lt;</span><span class="n">TextView</span><span class="p">&gt;(</span><span class="n">Resource</span><span class="p">.</span><span class="n">Id</span><span class="p">.</span><span class="n">textView4</span><span class="p">);</span>
</span><span class='line'>      <span class="n">textView5</span> <span class="p">=</span> <span class="n">FindViewById</span><span class="p">&lt;</span><span class="n">TextView</span><span class="p">&gt;(</span><span class="n">Resource</span><span class="p">.</span><span class="n">Id</span><span class="p">.</span><span class="n">textView5</span><span class="p">);</span>
</span><span class='line'>      <span class="n">textView6</span> <span class="p">=</span> <span class="n">FindViewById</span><span class="p">&lt;</span><span class="n">TextView</span><span class="p">&gt;(</span><span class="n">Resource</span><span class="p">.</span><span class="n">Id</span><span class="p">.</span><span class="n">textView6</span><span class="p">);</span>
</span><span class='line'>      <span class="n">textView7</span> <span class="p">=</span> <span class="n">FindViewById</span><span class="p">&lt;</span><span class="n">TextView</span><span class="p">&gt;(</span><span class="n">Resource</span><span class="p">.</span><span class="n">Id</span><span class="p">.</span><span class="n">textView7</span><span class="p">);</span>
</span><span class='line'>      <span class="n">textView8</span> <span class="p">=</span> <span class="n">FindViewById</span><span class="p">&lt;</span><span class="n">TextView</span><span class="p">&gt;(</span><span class="n">Resource</span><span class="p">.</span><span class="n">Id</span><span class="p">.</span><span class="n">textView8</span><span class="p">);</span>
</span><span class='line'>      <span class="n">textView9</span> <span class="p">=</span> <span class="n">FindViewById</span><span class="p">&lt;</span><span class="n">TextView</span><span class="p">&gt;(</span><span class="n">Resource</span><span class="p">.</span><span class="n">Id</span><span class="p">.</span><span class="n">textView9</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'>      <span class="n">imageView1</span> <span class="p">=</span> <span class="n">FindViewById</span><span class="p">&lt;</span><span class="n">ImageView</span><span class="p">&gt;(</span><span class="n">Resource</span><span class="p">.</span><span class="n">Id</span><span class="p">.</span><span class="n">imageView1</span><span class="p">);</span>
</span><span class='line'>      <span class="n">imageView2</span> <span class="p">=</span> <span class="n">FindViewById</span><span class="p">&lt;</span><span class="n">ImageView</span><span class="p">&gt;(</span><span class="n">Resource</span><span class="p">.</span><span class="n">Id</span><span class="p">.</span><span class="n">imageView2</span><span class="p">);</span>
</span><span class='line'>      <span class="n">imageView3</span> <span class="p">=</span> <span class="n">FindViewById</span><span class="p">&lt;</span><span class="n">ImageView</span><span class="p">&gt;(</span><span class="n">Resource</span><span class="p">.</span><span class="n">Id</span><span class="p">.</span><span class="n">imageView3</span><span class="p">);</span>
</span><span class='line'>      <span class="n">imageView4</span> <span class="p">=</span> <span class="n">FindViewById</span><span class="p">&lt;</span><span class="n">ImageView</span><span class="p">&gt;(</span><span class="n">Resource</span><span class="p">.</span><span class="n">Id</span><span class="p">.</span><span class="n">imageView4</span><span class="p">);</span>
</span><span class='line'>      <span class="n">imageView5</span> <span class="p">=</span> <span class="n">FindViewById</span><span class="p">&lt;</span><span class="n">ImageView</span><span class="p">&gt;(</span><span class="n">Resource</span><span class="p">.</span><span class="n">Id</span><span class="p">.</span><span class="n">imageView5</span><span class="p">);</span>
</span><span class='line'>      <span class="n">imageView6</span> <span class="p">=</span> <span class="n">FindViewById</span><span class="p">&lt;</span><span class="n">ImageView</span><span class="p">&gt;(</span><span class="n">Resource</span><span class="p">.</span><span class="n">Id</span><span class="p">.</span><span class="n">imageView6</span><span class="p">);</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>Now that&#8217;s a lot of code to do something really simple.  Plumbing code that&#8217;s so simple I&#8217;d rather not, and <em>shouldn&#8217;t have to</em> waste my time on it!  How about this instead:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
</pre></td><td class='code'><pre><code class='csharp'><span class='line'><span class="na">[Activity (Label = &quot;RandomDataActivity&quot;)]</span>            
</span><span class='line'><span class="k">public</span> <span class="k">class</span> <span class="nc">RandomDataActivity</span> <span class="p">:</span> <span class="n">Activity</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>  <span class="n">Button</span> <span class="n">button1</span><span class="p">;</span> <span class="n">Button</span> <span class="n">button2</span><span class="p">;</span> <span class="n">Button</span> <span class="n">button3</span><span class="p">;</span> <span class="n">Button</span> <span class="n">button4</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>  <span class="n">TextView</span> <span class="n">textView1</span><span class="p">;</span> <span class="n">TextView</span> <span class="n">textView2</span><span class="p">;</span> <span class="n">TextView</span> <span class="n">textView3</span><span class="p">;</span>
</span><span class='line'>  <span class="n">TextView</span> <span class="n">textView4</span><span class="p">;</span> <span class="n">TextView</span> <span class="n">textView5</span><span class="p">;</span> <span class="n">TextView</span> <span class="n">textView6</span><span class="p">;</span>
</span><span class='line'>  <span class="n">TextView</span> <span class="n">textView7</span><span class="p">;</span> <span class="n">TextView</span> <span class="n">textView8</span><span class="p">;</span> <span class="n">TextView</span> <span class="n">textView9</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>  <span class="n">ImageView</span> <span class="n">imageView1</span><span class="p">;</span> <span class="n">ImageView</span> <span class="n">imageView2</span><span class="p">;</span> <span class="n">ImageView</span> <span class="n">imageView3</span><span class="p">;</span>
</span><span class='line'>  <span class="n">ImageView</span> <span class="n">imageView4</span><span class="p">;</span> <span class="n">ImageView</span> <span class="n">imageView5</span><span class="p">;</span> <span class="n">ImageView</span> <span class="n">imageView6</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">protected</span> <span class="k">override</span> <span class="k">void</span> <span class="nf">OnCreate</span> <span class="p">(</span><span class="n">Bundle</span> <span class="n">bundle</span><span class="p">)</span>
</span><span class='line'>  <span class="p">{</span>
</span><span class='line'>      <span class="k">base</span><span class="p">.</span><span class="n">OnCreate</span> <span class="p">(</span><span class="n">bundle</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'>      <span class="n">SetContentView</span> <span class="p">(</span><span class="n">Resource</span><span class="p">.</span><span class="n">Layout</span><span class="p">.</span><span class="n">RandomDataLayout</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'>      <span class="k">this</span><span class="p">.</span><span class="n">WireUpViews</span> <span class="p">();</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>Here&#8217;s the extension method I created to do this:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
</pre></td><td class='code'><pre><code class='csharp'><span class='line'><span class="k">public</span> <span class="k">static</span> <span class="k">class</span> <span class="nc">ActivityExtensions</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>  <span class="k">public</span> <span class="k">static</span> <span class="k">void</span> <span class="nf">WireUpViews</span><span class="p">(</span><span class="k">this</span> <span class="n">Activity</span> <span class="n">activity</span><span class="p">)</span>
</span><span class='line'>  <span class="p">{</span>
</span><span class='line'>      <span class="c1">//Get all the View fields from the activity</span>
</span><span class='line'>      <span class="kt">var</span> <span class="n">members</span> <span class="p">=</span> <span class="k">from</span> <span class="n">m</span> <span class="k">in</span> <span class="n">activity</span><span class="p">.</span><span class="n">GetType</span> <span class="p">().</span><span class="n">GetFields</span> <span class="p">(</span><span class="n">BindingFlags</span><span class="p">.</span><span class="n">NonPublic</span> <span class="p">|</span> <span class="n">BindingFlags</span><span class="p">.</span><span class="n">Instance</span><span class="p">)</span>
</span><span class='line'>                    <span class="k">where</span> <span class="n">m</span><span class="p">.</span><span class="n">FieldType</span><span class="p">.</span><span class="n">IsSubclassOf</span> <span class="p">(</span><span class="k">typeof</span><span class="p">(</span><span class="n">View</span><span class="p">))</span>
</span><span class='line'>                    <span class="k">select</span> <span class="n">m</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>      <span class="k">if</span> <span class="p">(!</span><span class="n">members</span><span class="p">.</span><span class="n">Any</span> <span class="p">())</span>
</span><span class='line'>          <span class="k">return</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>      <span class="n">members</span><span class="p">.</span><span class="n">ToList</span> <span class="p">().</span><span class="n">ForEach</span> <span class="p">(</span><span class="n">m</span> <span class="p">=&gt;</span> <span class="p">{</span>
</span><span class='line'>          <span class="k">try</span>
</span><span class='line'>          <span class="p">{</span>
</span><span class='line'>              <span class="c1">//Find the android identifier with the same name</span>
</span><span class='line'>              <span class="kt">var</span> <span class="n">id</span> <span class="p">=</span> <span class="n">activity</span><span class="p">.</span><span class="n">Resources</span><span class="p">.</span><span class="n">GetIdentifier</span><span class="p">(</span><span class="n">m</span><span class="p">.</span><span class="n">Name</span><span class="p">,</span> <span class="s">&quot;id&quot;</span><span class="p">,</span> <span class="n">activity</span><span class="p">.</span><span class="n">PackageName</span><span class="p">);</span>
</span><span class='line'>              <span class="c1">//Set the activity field&#39;s value to the view with that identifier</span>
</span><span class='line'>              <span class="n">m</span><span class="p">.</span><span class="n">SetValue</span> <span class="p">(</span><span class="n">activity</span><span class="p">,</span> <span class="n">activity</span><span class="p">.</span><span class="n">FindViewById</span> <span class="p">(</span><span class="n">id</span><span class="p">));</span>
</span><span class='line'>          <span class="p">}</span>
</span><span class='line'>          <span class="k">catch</span> <span class="p">(</span><span class="n">Exception</span> <span class="n">ex</span><span class="p">)</span>
</span><span class='line'>          <span class="p">{</span>
</span><span class='line'>              <span class="k">throw</span> <span class="k">new</span> <span class="nf">MissingFieldException</span> <span class="p">(</span><span class="s">&quot;Failed to wire up the field &quot;</span>
</span><span class='line'>                                               <span class="p">+</span> <span class="n">m</span><span class="p">.</span><span class="n">Name</span> <span class="p">+</span> <span class="s">&quot; to a View in your layout with a corresponding identifier&quot;</span><span class="p">,</span> <span class="n">ex</span><span class="p">);</span>
</span><span class='line'>          <span class="p">}</span>
</span><span class='line'>      <span class="p">});</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>Ok, ok, I know it&#8217;s not perfect, but it&#8217;s a bit of a time saver, and keeps my code looking a bit neater.  In a perfect world I should just be able to use an android identifier as if it were already a declared as a code field.  There&#8217;s also room for improvement in my extension method, for example, what if you declare a field that&#8217;s a View but not in the layout, but you did this intentionally?  Well, I don&#8217;t want to do <strong><em>ALL</em></strong> your work for you ;)</p>

<p>Just wanted to share this little bit with you.  Hopefully it sparks some ideas for something greater in your day!  Happy Coding!</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Xamarin Studio Launcher]]></title>
    <link href="http://redth.info/Xamarin-Studio-Launcher"/>
    <updated>2013-05-31T00:00:00-04:00</updated>
    <id>http://redth.info/xamarin-studio-launcher</id>
    <content type="html"><![CDATA[<p><strong>UPDATE: Sep 8, 2014</strong>: The original launcher works well, but after Xamarin 3.0, it didn&#8217;t look so up to date.  There were a couple people that took it upon themselves to update it, and thanks for that!  Now, I&#8217;ve released my own updated copy, so please download and try again!</p>

<p><img src="http://redth.info/images/Xamarin-Studio-Launcher/Xamarin.Studio.Launcher.Icon.png" alt="Xamarin Studio Launcher" /></p>

<p>I&#8217;ve recently converted to a Mac.  As a long time Windows user, one thing I was very accustomed to was keeping multiple visual studio, or more recently, Xamarin Studio instances open at any given time.  Switching to a Mac I found this isn&#8217;t so easy, so I decided to make a nice little Launcher application to open new Xamarin Studio instances at will!</p>

<p>So, without further ado, please download the Xamarin Studio Launcher!</p>

<p><a href="https://dl.dropboxusercontent.com/u/56106/Xamarin.Studio.Launcher.dmg">Download Xamarin Studio Launcher</a></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[MobiDevDay Detroit 2013]]></title>
    <link href="http://redth.info/MobiDevDay-Detroit-2013"/>
    <updated>2013-05-04T00:00:00-04:00</updated>
    <id>http://redth.info/mobidevday-detroit</id>
    <content type="html"><![CDATA[<p>Had a great turnout and lots of solid questions at my talk on Xamarin and C# at <a href="http://mobidevdaydetroit.com">Detroit MobiDevDay 2013</a>.  I&#8217;ve got my slides posted for anyone who cares to have a look!</p>

<p>Thanks to <a href="http://twitter.com/@MobiDevDay">@MobiDevDay</a> for having me, and to all those who came out!</p>

<!-- more -->


<h2>MobiDevDay Detorit - Native Cross Platform Mobile with Xamarin and C</h2>

<p>Create iOS, Android, Mac, and Windows Phone apps in C#.  Reuse code, and leverage existing .NET libraries and frameworks, while applying the same C# skillset everywhere to create truly native apps across mobile platforms.  This session looks at why you&#8217;ll love using Xamarin&#8217;s popular mobile development tools to create native applications to increase productivity, while creating a first class native user experience across the most popular mobile platforms.  This isn&#8217;t your grandmother&#8217;s hybrid web app, this is real native, platform API&#8217;s, and raw power.</p>

<p><a href="https://speakerdeck.com/redth/mobidevday-detorit-native-cross-platform-mobile-with-xamarin-and-c-number">Speaker Deck - MobiDevDay Detorit - Native Cross Platform Mobile with Xamarin and C#</a></p>

<script async="true" class="speakerdeck-embed" data-id="871ea670970b013068950e97ee62c877" src="http://redth.info//speakerdeck.com/assets/embed.js"> </script>



]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Xamarin Evolve 2013]]></title>
    <link href="http://redth.info/xamarin-evolve-2013"/>
    <updated>2013-04-20T00:00:00-04:00</updated>
    <id>http://redth.info/xamarin-evolve-2013 copy</id>
    <content type="html"><![CDATA[<p>Xamarin Evolve 2013 was an Awesome conference!  I got to see a lot of familiar faces, and meet plenty of new ones!  It&#8217;s such a great experience to see and talk with such great people who I&#8217;d only otherwise know online!</p>

<p>I also had the great privilege to do some speaking at Evolve!  I&#8217;ve posted my slides below and will update the post with links to the videos when they are available!</p>

<p>Thanks to Xamarin and everyone who made this such a great event!</p>

<!-- more -->


<h2>Push Notifications with PushSharp</h2>

<p>Push Notifications are a great way to update users of you app with alerts and information in an effective, standard, and efficient way.  Come and learn about what Push Notifications are and how they work on all the mobile platforms, and how you can use PushSharp to deliver notifications to your apps!</p>

<p><a href="https://speakerdeck.com/redth/xamarin-evolve-2013-push-notifications-with-pushsharp">Speaker Deck - Push Notifications with PushSharp</a></p>

<script async="true" class="speakerdeck-embed" data-id="bea8f1408c130130cb61123138155451" src="http://redth.info//speakerdeck.com/assets/embed.js"> </script>


<h2>Barcode Scanning with ZXing</h2>

<p>Barcodes have become increasingly popular in the Mobile space.  Learn how you can easily include scanning support with custom overlays using the ZXing.Net.Mobile component.  You will also learn how to generate barcodes from within your apps.  This session will also discuss various barcode scanning options, and the making of the ZXing.Net.Mobile component.</p>

<p><a href="https://speakerdeck.com/redth/xamarin-evolve-2013-cross-platform-barcode-scanning-with-zxing#">Speaker Deck - Cross Platform Barcode Scanning with ZXing</a></p>

<script async="true" class="speakerdeck-embed" data-id="4640de208c160130007512313d181421" src="http://redth.info//speakerdeck.com/assets/embed.js"> </script>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[A Month With Android]]></title>
    <link href="http://redth.info/month-with-android"/>
    <updated>2013-02-28T00:00:00-05:00</updated>
    <id>http://redth.info/a-month-with-android</id>
    <content type="html"><![CDATA[<p>Just before the new year, <a href="http://redth.info/why-i-am-looking-forward-to-android">I wrote a post about switching back to Android</a> (to a Nexus 4), and I was excited at the prospect.  I explained that Iâ€™d been a long time iOS user (quite happily so), except for a brief stint on Android 2.3 (Gingerbread) which ended not so well.</p>

<p>Well, itâ€™s been about a month now since Iâ€™ve switched back to Android, and Iâ€™m not looking back anytime soon!  Iâ€™m going to do a quick recap about the things I love, and the things I miss:</p>

<!-- more -->


<h2>What I Love</h2>

<ul>
<li><strong>Pre-Load All the Things!</strong> This is something Iâ€™m surprised people donâ€™t complain more about, and one thing that has bothered me about iOS since day one.  Itâ€™s gotten better with faster devices and faster network connections, but I <em>REALLY</em> hate getting for instance, a Twitter notification, and then once I launch the app, having to wait for the item that triggered the notification to be loaded.  I really love it when Android apps go out and prefetch this data when a Push Notification comes in, so that when I decided to act on the notification and open the app, the data is already there.  The same goes for email.  If you donâ€™t want to use the default mail app, every time you open the mail app (Gmail for instance), you must wait for the data to load, even though you probably already know who the email is from since it told you in the push notification.  I cannot stress enough <em>HOW MUCH TIME</em> this has given back to me on Android.</li>
<li><strong>Real Estate Maven</strong> I always thought the bigger phones were too big.  I drank the iPhone screen size Kool-Aid, but I loved the bigger iPhone 5.  I will say that 6â€ seems too big still, but my 4.7â€ Nexus 4 screen is just awesome.  It still fits easily in my pocket, and the added real estate is great for typing, and browsing.  Even the iPhone 5 feels too tiny now when I have it in my hands.</li>
<li><strong>The Google Experience</strong> Iâ€™m a big user of Google services, so it comes as no surprise that I love the Google apps on Android.  Google has recently improved its iOS offering dramatically, but at the end of the day it still works just a bit better on Android.</li>
<li><strong>Settings Quick Toggles</strong> In the pull down notification bar, thereâ€™s a button that flips to a view of tiles of several shortcuts to settings, such as Brightness, WiFi, Airplane mode, Bluetooth.  In 4.2.2, you can now quickly toggle some of these things on and off from this menu.  So, to toggle WiFi, I swipe down, tap the settings button, and tap and hold the WiFi.  Pretty quick and less annoying than iOS</li>
</ul>


<blockquote><p><img src="http://redth.info/images/Android-Love/Quick-Toggles.png" alt="Quick Toggle Settings" /></p></blockquote>

<ul>
<li><strong>Apps without Borders</strong> One thing that always bugged me about iOS as an end user was how each app felt like the lonely island it was.  I love in Android how when I tap a link, or perform some action, Iâ€™ll get a little menu asking me which App Iâ€™d like to have handle this action.  iOS does this to an extent now, but Android is better at it, and Android effectively lets me choose a default App to deal with the content type.  I love not being forced into using the default Mail app or Browser, if I donâ€™t want to!</li>
</ul>


<blockquote><p><img src="http://redth.info/images/Android-Love/Share-Content.png" alt="Sharing Content" /></p></blockquote>

<ul>
<li><strong>Google Now</strong> Siri is great, but Google Now is better in almost all respects.  I find the voice transcription way faster and more accurate, and Google Nowâ€™s â€˜cardâ€™ design really works for me.  If you can get over the fact Google is in your email, you can learn to love having a card pop up with tracking info on the package you just ordered, or movie tickets you bought.  Thereâ€™s so much depth to Google Now it could be its own post, but itâ€™s safe to say I really like it.</li>
</ul>


<blockquote><p><img src="http://redth.info/images/Android-Love/Google-Now-Cards.png" alt="Google Now Cards" /></p></blockquote>

<ul>
<li><strong>Notifications</strong> Iâ€™ve always liked Googleâ€™s notification bar way better than how iOS deals with it, so Iâ€™m not surprised to feel right at home with it.  I am pleasantly surprised, however, at how useful having an LED indicator for notifications is.  The LED basically allows me to decide if I need to even turn my screen on or not.  I also really like how apps are starting to take advantage of rich notifications in the pull down tray.  Music apps allow me to skip next, twitter notifications allow me to tap reply right from in the tray.  This is a really strong point for Android, and I find myself wasting much less time on Notifications than I did in iOS</li>
</ul>


<blockquote><p><img src="http://redth.info/images/Android-Love/Rich-Notification.png" alt="Rich Notifications" /></p></blockquote>

<ul>
<li><strong>UI</strong> This is where many of you will disagree with me.  I actually have taken a strong liking to the Android UI, or at least the apps that do a good job of it.  If you havenâ€™t played with Android recently, you may not realize that developers have started to take care with how they design their apps.  Thereâ€™s still a lot of junk out there, but for nearly any App I use on a regular basis, thereâ€™s a very nicely designed app Available now.</li>
<li><strong>Lock Screen</strong> Thereâ€™s three things I love about the lock screen on Android.  Using a pattern to unlock my screen as opposed to a numeric code, Having widgets on my lock screen, and specifically, DashClock which adds many notification icon types to the lock screen (much like windows phone 8) â€“ Itâ€™s a beautifully designed app and something Iâ€™d love to see integrated right into Android</li>
</ul>


<blockquote><p><img src="http://redth.info/images/Android-Love/Lock-Screen.png" alt="Lock Screen" /></p></blockquote>

<ul>
<li><strong>FREEEDOM!!!</strong> Seriously though, itâ€™s really liberating not being told you canâ€™t do something on your device.  If I want to use a different keyboard, I can.  If I want to use a different default Mail app, I can.  I am sick of Apple telling me to do things a certain way.  I realize for most users, that is fine, but Iâ€™m a power user darnit, let me tweak!</li>
</ul>


<h2>What I Miss</h2>

<p>Thereâ€™s a few things I do, genuinely miss from iOS.  Luckily, none of them are really dealbreakers for me:</p>

<ul>
<li><strong>iMessage</strong> Many of my friends and family (including my wife) have iPhones.  I have unlimited texting, so itâ€™s not that big of a deal not to have iMessage, but I found it oddly more reliable than sending text messages (especially between carriers) in some cases.  Iâ€™ve mostly switched to Facebook Messenger if Iâ€™m chatting with a friend whoâ€™s on facebook (which most are).</li>
<li><strong>Fit &amp; Finish</strong> I really only added this in because I felt a bit of a traitor since my list of things I miss is so short.  There is some truth here though, thereâ€™s plenty of apps that look nasty.  Luckily, most of those apps are apps I do not use.  At this point the market is mature enough that you can pretty much find an app that looks good to do whatever you need.  I expect this to only get better!</li>
</ul>


<h2>These are a few of my favourite apps</h2>

<p>After all this talk, I thought it would be a good idea to show what Apps I use regularly.  Hereâ€™s my top 10:</p>

<ol>
<li><a href="https://play.google.com/store/apps/details?id=net.nurik.roman.dashclock">DashClock</a> â€“ I already mentioned it, and itâ€™s not really an App, but a lock screen widget.  If you have Android 4.2+, you MUST get this app, and some of the addons for it</li>
<li><a href="https://play.google.com/store/apps/details?id=com.dotsandlines.carbon">Carbon for Twitter</a> â€“ Itâ€™s relatively new, but this is the Twitter app Android has been waiting for</li>
<li><a href="https://play.google.com/store/apps/details?id=com.facebook.katana">Facebook</a> â€“ OK, my friends are all doing it, so I need it to.  The App is quite well done (native) on Android nowadays</li>
<li><a href="https://play.google.com/store/apps/details?id=com.devhd.feedly">Feedly</a> â€“ I use Google Reader, and it was a struggle to find a decent app for it.  Feedly fills this gap for me</li>
<li><a href="https://play.google.com/store/apps/details?id=com.podkicker">Podkicker</a> â€“ Podcasts occupy my long commutes, so a decent podcast app is a requirement.  Doggcatcher is good too, but a bit overly complicated.  Podkicker is lean, fast, simple, and looks nice</li>
<li>Chrome, Gmail, Google Talk â€“ Iâ€™ll lump these all together since they come by default, but they really are very well done.  I love using Chrome on my mobile!</li>
<li><a href="https://play.google.com/store/apps/details?id=com.dropbox.android">Dropbox</a> â€“ I tend to use this one daily.  Itâ€™s very solid and well constructed for android.</li>
<li>Google Maps â€“ Itâ€™s still better on Android than iOS!  I love the offline caching feature too, so useful as I live near Detroit and go over there a lot, but donâ€™t want to incur the roaming data fees</li>
<li><a href="https://play.google.com/store/apps/details?id=com.onelouder.baconreader.premium">BaconReader</a> â€“ This is my reddit client of choice</li>
<li><a href="https://play.google.com/store/apps/details?id=com.handmark.expressweather">1Weather</a> â€“ a beautiful weather app.  Hereâ€™s a great example of the potential for nice looking apps on Android</li>
</ol>


<p>So, to sum it all up, Iâ€™m very happy with my Nexus 4.  Both from a hardware perspective, but Iâ€™m also really enjoying Android 4.2, it feels much more polished, useful, functional, efficient, etc.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Why I'm Looking forward to Android]]></title>
    <link href="http://redth.info/why-i-am-looking-forward-to-android"/>
    <updated>2012-12-28T00:00:00-05:00</updated>
    <id>http://redth.info/why-i-am-looking-forward-to-android</id>
    <content type="html"><![CDATA[<p><img src="http://redth.info/images/Android-And-Back/iOS-to-Android.jpg" alt="Mou icon" /></p>

<h2>The Back Story</h2>

<p>Way back in Froyo days, I took the leap from my iPhone 3G to Android as my daily device with a Samsung Galaxy S.  I was co-authoring a book <strong><a href="http://www.amazon.com/gp/product/1118026438/ref=as_li_qf_sp_asin_tl?ie=UTF8&amp;camp=1789&amp;creative=9325&amp;creativeASIN=1118026438&amp;linkCode=as2&amp;tag=red082-20">Professional Android Development with Mono and C#/.NET</a></strong></p>

<p>Android was new, it was exciting, it was <em>different</em>.  It was also slower, higher maintenance, and had me flashing roms weekly.  Not necessarily a problem for a supergeek like me, but still tiresome and prone to moments of <em>Oh sorry, that&#8217;s a bug in my phone&#8217;s rom</em> or <em>my battery&#8217;s dead because of all the services i have running</em>.</p>

<p>Needless to say, it wasn&#8217;t very long before I was back on the iPhone train.  I was content with the iPhone 4, and then the iPhone 4S, and now the iPhone 5.  They&#8217;re all great devices, they just workâ€¦ as long as you want to use them how Apple intends.</p>

<p>The primary reasn I&#8217;m switching back to Android, is my Galaxy S just doesn&#8217;t cut it for development anymore.  My wonderful wife will inherit my iPhone 5 (like she does all my devices), and I&#8217;ll have a Nexus 4 to test on soon.</p>

<!-- more -->


<h2>Why I&#8217;m looking forward to Android</h2>

<p>I have a Nexus 7.  It&#8217;s quite nice.  I like it better than the iPad, with the exception of a lack of apps in some areas (games).  Android 4.2, I feel, finally starts to get things right.  Sure there&#8217;s still issues, but by and large it&#8217;s a good operating system.  The eco-system is also quite mature now.  Most, if not all the apps I use daily on iOS (which seems to be less nowadays) all exist in a reasonably good form on Android (save for maybe a really good Twitter client, but that&#8217;s something I&#8217;m currently working to fix!).</p>

<p>I&#8217;m getting excited for Android.  See, the iPhone was great, but there are a lot of <em>compromises</em> I&#8217;ve had to make to be a happy iOS user.  When I think about the things that bug me with iOS, Android largely has them right:</p>

<ol>
<li><strong>Gmail:</strong> Ok, Google <em>JUST</em> released a better Gmail app for iOS again.  They actually did this just after I ordered my Nexus 4.  It&#8217;s much better, however it&#8217;s still not as awesome as Gmail on Android.</li>
<li><strong>Default Apps:</strong> Chrome, Gmail, Google Maps, all great apps and services.  But on iOS, I can&#8217;t choose to have links open in Chrome, I can&#8217;t choose Gmail as my default mail client, nor can I have Google Maps default for navigation.  I love that on Android I can finally do these things.</li>
<li><strong>LockScreen Patterns:</strong> I have a confession:  I&#8217;ve not got any passcode set on my iPhone.  I hate typing in passwords every time I want to unlock my screen.  One thing I loved on Android was the pattern unlock.  It felt much quicker, more intuitive, just easier.  I&#8217;m happy to get back some security with little pain!</li>
<li><strong>Lockscreen Widgets:</strong> This is a pet peave of mine on iOS.  At least notifications show up now, but I want to be able to see a bit more information so I can glance at the lockscreen and decide if I should open my phone or not.  This is welcomed in android!</li>
<li><strong>Notification Bar:</strong> Google invented the notification bar.  It&#8217;s way better than iOS&#8217;s.  I love how it shows a small icon in the status bar at the top of the screen, alluding to there being more notifications.  I also like how rich notifications can be in Android, and that I can swipe individual ones away, or clear the whole lot of them.  It&#8217;s just a much better implementation.</li>
<li><strong>Google Now:</strong> Siri is great, but Google Now seems more well thought out.  Since I already use gmail, I&#8217;m looking forward to getting <em>cards</em> with shipping status of things I&#8217;ve ordered, or <a href="http://venturebeat.com/2012/12/05/google-now-boarding-pass/" title="boarding passes">boarding passes</a>, automatically, without me telling it.  This is a great system that surely requires some tweaking yet, but the idea that Google can give me the information I want when I need it, without me asking for it is awesome!</li>
<li><strong>Google Maps:</strong> Just like Gmail, google <em>JUST</em> released a maps app for the iPhone.  It&#8217;s actually really, really good!  I am however, still looking forward to being able to cache some areas offline, and having Google Maps used as the <em>default</em> navigation app on my OS.</li>
<li><strong>No Lightning:</strong> I still have only one lightning cable, partially because they&#8217;re hard to find, and partially because I HATE spending $20 on a usb cable.  I do love that the cable is reversable, but it&#8217;s not compelling enough for me not to be excited about having an endless supply of charging cables again :)</li>
</ol>


<h2>What I&#8217;ll Miss</h2>

<p><img src="http://redth.info/images/Android-And-Back/iphone-sad.jpg" alt="Mou icon" /></p>

<p>Let&#8217;s be honest.  There&#8217;s some things iOS just does right.  I&#8217;ll no doubt miss several things about my iPhone, but I think we&#8217;re finally at the stage the things I miss on Android are greater than those I miss on iPhone:</p>

<ol>
<li><strong>Apps!</strong> Yeah, the Android ecosystem is WAY better than back in Froyo days, but iPhone still wins when it comes to games, and just sheer quantity of <em>quality</em> apps.  I&#8217;ll miss this, though not as much as I would have years ago.</li>
<li><strong>Fit &amp; Finish:</strong> iPhone is a very polished OS.  There&#8217;s no denying this.  Android has made strides to improve the <strong><em>butter</em></strong>yness of the interface, but iPhone is still king for that polished feeling.</li>
<li><strong>Siri:</strong> One thing I already know google now can&#8217;t do is create reminders for a future day.  I&#8217;m sure this will get added at some point, but it&#8217;s one thing I use a lot with Siri right now, and I&#8217;m going to miss it!</li>
<li><strong>Airplay:</strong> This is actually the big thing I&#8217;m going to miss.  I have two Apple TV&#8217;s, and while I don&#8217;t use it a lot, Airplay screen mirroring is incredibly useful when I do want it.  Android just doesn&#8217;t do this, and there&#8217;s no silver bullet in sight.  I guess I&#8217;ll have to pull out the iPad when I want to do this!  At least I can still control my iTunes remotely on Android and have it play to my AppleTV!</li>
</ol>


<h2>What&#8217;s Next?</h2>

<p>It&#8217;s hard to say whether I&#8217;ll love Android, or find some of the same things annoying that caused me to switch back to iPhone.  I&#8217;m sure there will be some remorse at times, but I think overall, I&#8217;ll really enjoy being back on Android for all the right reasons.  Plus, now I can finally stop having people ask me why I use an iPhone once they find out I helped write <a href="http://www.amazon.com/gp/product/1118026438/ref=as_li_qf_sp_asin_tl?ie=UTF8&amp;camp=1789&amp;creative=9325&amp;creativeASIN=1118026438&amp;linkCode=as2&amp;tag=red082-20" title="a book on Android programming">a book on Android programming</a>!  Stay tuned, I&#8217;ll be posting again after using my Nexus 4 for awhile to see how it&#8217;s going!</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Get your MonoTouch apps ready for iPhone 5 / iOS 6 today!]]></title>
    <link href="http://redth.info/get-your-monotouch-apps-ready-for-iphone-5-today"/>
    <updated>2012-09-13T00:00:00-04:00</updated>
    <id>http://redth.info/get-your-monotouch-apps-ready-for-iphone-5-today</id>
    <content type="html"><![CDATA[<p>So the new iPhone 5 has arrived, as well as the Gold Master iOS6 SDK!  Hurray!</p>

<!-- more -->


<p>Unless you&#8217;ve been under a rock, you know that the iPhone 5 has a taller screen, which means a new screen resolution to deal with for us developers!  Apple is lacking  bit in their own documentation, but a few developers have figured out how to best handle the new resolution.</p>

<p>First of all, the new resolution is <em>640x1136</em>, that&#8217;s 640 pixels wide, by 1136 high.  Now, just like the Retina display, even though this is the resolution, many parts of the iOS API report back the sizes in points rather than pixels, which means the new size in points is really <em>320x568</em>.  I&#8217;d like to share with you how you can get your MonoTouch apps up and running to be compatible with the new resolution today!</p>

<h3>First, Install the X-Code 4.5 GM iOS6 SDK from the Apple Developer site</h3>

<p>It&#8217;s listed as the iOS6 beta at the time of writing this post, but it&#8217;s really GM once you get to the download section.  You must be part of the paid Apple Developer program to be able to access this.  Download the .dmg, mount it, and drag XCode into your Applications folder.  You may want to rename the old one so you can revert to it if need be.  I renamed the old one <em>XCode 4.4.1.app</em>.</p>

<h3>Create a Default.png of the correct size</h3>

<p>The way that iOS6 determines if your app is Tall compatible or not is by looking for a specifically sized and named image file for your splash/default screen.  The name of this file is:</p>

<blockquote><p>Default-568h@2x.png</p></blockquote>

<p>This file must actually be <em>640x1136</em> pixels in size.
Add this file to your MonoTouch Application Project, and make sure the Build mode is set to Content.</p>

<blockquote><p><img src="http://redth.info/images/MonoTouch-iPhone5/Default-568h.png" alt="" /></p></blockquote>

<h3>Change the Simulator to iPhone (Retina 4-inch)</h3>

<p>After your MonoTouch Application starts in debug mode, you may need to change the Simulator to use the new hardware type.  Go to the Hardware -> Device menu, and select â€œ<em>iPhone (Retina 4-inch)</em>â€.  You may need to re-launch your app after doing this.</p>

<blockquote><p><img src="http://redth.info/images/MonoTouch-iPhone5/iPhone5-Simulator.png" alt="" /></p></blockquote>

<p>Presto, your app now runs in â€˜Tall&#8217; mode!</p>

<h3>Create new sizes of other Image assets</h3>

<p>Unfortunately, the image naming convention of -568h@2x.png only seems to extend to the Default image, but not other images in your application.  This means if you&#8217;re using a custom background image for your view (eg: UITableView background), you will likely need to create a new background image of the correct resolution, and determine in your application when to use each image.</p>

<p>For example, in my non-4inch compatible app, I have two images:</p>

<ol>
<li>Images/TableViewBackground.png â€“ <em>320x358</em></li>
<li>Images/TableViewBackground@2x.png â€“ <em>640x716</em></li>
</ol>


<p>With the new resolution, I&#8217;ll need to create a third image (I&#8217;ve decided to use the -568h@2x.png naming convention even though it isn&#8217;t observed by Apple):</p>

<ol>
<li>Images/TableViewBackground-568h@2x.png</li>
</ol>


<h3>Write some code to detect iPhone 5 and use the new Image Assets</h3>

<p>Now as I mentioned, even though I&#8217;ve named the image just like the way Apple detects the new default image, iOS6 (at least currently) doesn&#8217;t know to use it automatically, so we have to write some code to detect when the app is running on an iPhone 5, and then to use the correct image when that&#8217;s the case.</p>

<p>Here&#8217;s some sample code to detect whether or not we have an iPhone 5.  I&#8217;ve elected to call it â€˜Tall&#8217; detection, as the iPhone 6 will likely use this tall resolution too. <strong>NOTE:</strong> Thanks to <a href="http://twitter.com/jtclancey" title="@jtclancey">@Clancey</a> for some additions to the IsTall detection!</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class='csharp'><span class='line'><span class="k">public</span> <span class="k">static</span> <span class="kt">bool</span> <span class="n">IsTall</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>  <span class="k">get</span>
</span><span class='line'>  <span class="p">{</span>
</span><span class='line'>    <span class="k">return</span> <span class="n">UIDevice</span><span class="p">.</span><span class="n">CurrentDevice</span><span class="p">.</span><span class="n">UserInterfaceIdiom</span>
</span><span class='line'>             <span class="p">==</span> <span class="n">UIUserInterfaceIdiom</span><span class="p">.</span><span class="n">Phone</span>
</span><span class='line'>           <span class="p">&amp;&amp;</span> <span class="n">UIScreen</span><span class="p">.</span><span class="n">MainScreen</span><span class="p">.</span><span class="n">Bounds</span><span class="p">.</span><span class="n">Height</span>
</span><span class='line'>             <span class="p">*</span> <span class="n">UIScreen</span><span class="p">.</span><span class="n">MainScreen</span><span class="p">.</span><span class="n">Scale</span> <span class="p">&gt;=</span> <span class="m">1136</span><span class="p">;</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>Finally, the approach I take in my applications is to use a common property for the image, and make that property getter decide on the height of the device, and which image to return:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
</pre></td><td class='code'><pre><code class='csharp'><span class='line'><span class="k">static</span> <span class="n">UIImage</span> <span class="n">tableViewBackgroundImage</span> <span class="p">=</span> <span class="k">null</span><span class="p">;</span>
</span><span class='line'><span class="k">public</span> <span class="k">static</span> <span class="n">UIImage</span> <span class="n">TableViewBackgroundImage</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>  <span class="k">get</span>
</span><span class='line'>  <span class="p">{</span>
</span><span class='line'>      <span class="k">if</span> <span class="p">(</span><span class="n">tableViewBackgroundImage</span> <span class="p">==</span> <span class="k">null</span><span class="p">)</span>
</span><span class='line'>          <span class="n">tableViewBackgroundImage</span> <span class="p">=</span> <span class="n">IsTall</span>
</span><span class='line'>              <span class="p">?</span> <span class="n">UIImage</span><span class="p">.</span><span class="n">FromFile</span><span class="p">(</span><span class="s">&quot;Images/TableViewBackground-568h@2x.png&quot;</span><span class="p">)</span>
</span><span class='line'>              <span class="p">:</span> <span class="n">UIImage</span><span class="p">.</span><span class="n">FromFile</span><span class="p">(</span><span class="s">&quot;Images/TableViewBackground.png&quot;</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'>      <span class="k">return</span> <span class="n">tableViewBackgroundImage</span><span class="p">;</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>In this example, I keep a single static instance of my background image around, and lazy load it based on whether or not it&#8217;s a tall device.  This way the same image instance is shared for multiple viewcontrollers that use it!  In the case where it&#8217;s not a tall device, Apple still obeys the @2x.png naming convention to load retina graphics automatically, so you still don&#8217;t have to do that detection, it&#8217;s done for you.</p>

<h3>Other considerations</h3>

<p>If you have any other code that does anything with height calculations, or maybe creating a view to be a certain height, you may also need to update this code.  The general rule is you should now be calculating heights and y-coordinates based on the UIScreen.MainScreen.ApplicationFrame or UIScreen.MainScreen.Bounds.  This is probably a good practice anyway, and hopefully you don&#8217;t need to do too much work since you&#8217;ve already been following that good practice, right?</p>

<p>Hopefully that helps get your MonoTouch apps prepared for iPhone 5, before it&#8217;s even out!</p>

<h2>UPDATE:</h2>

<h3>Select the right Image!</h3>

<p><a href="http://twitter.com/martinbowling" title="@martinbowling">@martinbowling</a> contributed another nice method to add to your &#8216;helper&#8217; class shortly after this post was originally published.  It will help you select the right Image in code, easily!  It expects that you name your &#8216;Tall&#8217; image files with the <em>-568h@2x</em> convention.  This is another, even better technique than I&#8217;ve illustrated above.  Perhaps Xamarin will adopt this method in the future&#8230;</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
</pre></td><td class='code'><pre><code class='csharp'><span class='line'><span class="k">private</span> <span class="k">static</span> <span class="kt">string</span> <span class="n">tallMagic</span> <span class="p">=</span> <span class="s">&quot;-568h@2x&quot;</span><span class="p">;</span>
</span><span class='line'><span class="k">public</span> <span class="k">static</span> <span class="n">UIImage</span> <span class="nf">FromBundle16x9</span><span class="p">(</span><span class="kt">string</span> <span class="n">path</span><span class="p">)</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>  <span class="c1">//adopt the -568h@2x naming convention</span>
</span><span class='line'>  <span class="k">if</span><span class="p">(</span><span class="n">IsTall</span><span class="p">())</span>
</span><span class='line'>  <span class="p">{</span>
</span><span class='line'>      <span class="kt">var</span> <span class="n">imagePath</span> <span class="p">=</span> <span class="n">Path</span><span class="p">.</span><span class="n">GetDirectoryName</span><span class="p">(</span><span class="n">path</span><span class="p">.</span><span class="n">ToString</span><span class="p">());</span>
</span><span class='line'>      <span class="kt">var</span> <span class="n">imageFile</span> <span class="p">=</span> <span class="n">Path</span><span class="p">.</span><span class="n">GetFileNameWithoutExtension</span><span class="p">(</span><span class="n">path</span><span class="p">.</span><span class="n">ToString</span><span class="p">());</span>
</span><span class='line'>      <span class="kt">var</span> <span class="n">imageExt</span> <span class="p">=</span> <span class="n">Path</span><span class="p">.</span><span class="n">GetExtension</span><span class="p">(</span><span class="n">path</span><span class="p">.</span><span class="n">ToString</span><span class="p">());</span>
</span><span class='line'>      
</span><span class='line'>      <span class="n">imageFile</span> <span class="p">=</span> <span class="n">imageFile</span> <span class="p">+</span> <span class="n">tallMagic</span> <span class="p">+</span> <span class="n">imageExt</span><span class="p">;</span>
</span><span class='line'>      
</span><span class='line'>      <span class="k">return</span> <span class="n">UIImage</span><span class="p">.</span><span class="n">FromFile</span><span class="p">(</span><span class="n">Path</span><span class="p">.</span><span class="n">Combine</span><span class="p">(</span><span class="n">imagePath</span><span class="p">,</span><span class="n">imageFile</span><span class="p">));</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'>  <span class="k">else</span>
</span><span class='line'>  <span class="p">{</span>
</span><span class='line'>      <span class="k">return</span> <span class="n">UIImage</span><span class="p">.</span><span class="n">FromBundle</span><span class="p">(</span><span class="n">path</span><span class="p">.</span><span class="n">ToString</span><span class="p">());</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[The problem with Apples Push Notification Service... Solutions and Workarounds...]]></title>
    <link href="http://redth.info/the-problem-with-apples-push-notification-ser"/>
    <updated>2012-09-06T00:00:00-04:00</updated>
    <id>http://redth.info/the-problem-with-apples-push-notification-ser</id>
    <content type="html"><![CDATA[<p>Push Notifications have intrigued me since Apple first introduced them in iOS years ago.  RIM had been doing this for a while, but as a platform it never excited me.  As soon as the documentation for their APNs protocol was released I started busily implementing a solution to send push notifications in C#.  The first version of the protocol was already terrible, but Iâ€™m not going to harp on that as weâ€™ve got a newer version thatâ€™s only slightly better to tear apart.</p>

<p>Iâ€™m the author of PushSharp (https://github.com/Redth/PushSharp) which is a .NET library to assist developers in delivering push notifications on as many platforms as possible (iOS, Android, Windows, Windows Phone, and HTML5).  This library was the culmination of my previous efforts in individual libraries (APNS-Sharp and C2DM-Sharp mostly), and represents a more abstracted, standardized, easier way to support push notifications on all the platforms you may target as a developer.</p>

<p>This post is a chance for me to vent, to explore my frustrations with Appleâ€™s APNS protocol, and hope that they somehow listen and change it.  Youâ€™ll notice how thereâ€™s no complaining about the way the other platforms implement their protocols.  This is because they arenâ€™t terrible (though they arenâ€™t perfect either).</p>

<!-- more -->


<h3>Appleâ€™s Enhanced Format for Push Notifications</h3>

<p>I had great hopes that Apple finally fixed its protocol when they introduced the Enhanced format (basically v2 of their protocol).  Both the original and the enhanced format are binary protocols.  You can quickly see the differences between the two in the diagrams below:</p>

<blockquote><p>Original Protocol:
<img src="http://redth.info/images/Problem-With-APNS/Original-Binary-Protocol.png" alt="" /></p>

<p>Enhanced Protocol:
<img src="http://redth.info/images/Problem-With-APNS/Enhanced-Binary-Protocol.png" alt="" /></p></blockquote>

<p>Youâ€™ll notice that in the enhanced protocol, thereâ€™s two additional bits of information (besides the first byte being 1, indicating that itâ€™s the new protocol as opposed to 0 in the original).  These are two very good additions to the protocol:</p>

<ol>
<li><p>Identifier â€“ Your own 4 byte data to uniquely identify the notification â€“ this is important as itâ€™s returned to you in the error response packet if thereâ€™s a problem.</p></li>
<li><p>Expiry â€“ A point in time after which the message is no longer valid if it has not already been delivered and can be discarded from Appleâ€™s servers</p></li>
</ol>


<p>In the original protocol, whenever you send Apple a notification that has a problem with it (maybe itâ€™s too big, or it has an invalid device token or malformed payload, etc.), it simply closes the TCP connection without any warning.  You are left to assume something is corrupt in your notification.</p>

<p>With the enhanced protocol also handles bad notifications it receives a bit differently. It still closes the connection to you when thereâ€™s an error, but before it does so, it sends back an error response packet.  You can see the format in the diagram below, along with a list of status codes and their meanings:</p>

<blockquote><p>Error Response Packet:
<img src="http://redth.info/images/Problem-With-APNS/Error-Response-Packet.png" alt="" /></p></blockquote>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>Status Codes & Meanings
</span><span class='line'>0  - No errors encountered
</span><span class='line'>1   - Processing error
</span><span class='line'>2   - Missing device token
</span><span class='line'>3   - Missing topic
</span><span class='line'>4   - Missing payload
</span><span class='line'>5   - Invalid token size
</span><span class='line'>6   - Invalid topic size
</span><span class='line'>7   - Invalid payload size
</span><span class='line'>8   - Invalid token
</span><span class='line'>255 - None (unknown)</span></code></pre></td></tr></table></div></figure>


<p>This packet is quite simple, with the first byte presumably indicating the protocol version, the second byte being the status or error code (Apple provides us with a list of status codes and what they mean â€“ interestingly enough one of the status codes is â€˜0 â€“ No errors encounteredâ€™ â€“ just keep this in mind for later).  The final piece of info is the Identifier.  This identifier will correspond to the identifier of the notification you sent which caused the error condition.</p>

<h3>Whatâ€™s the problem here?</h3>

<p>So far so good, right? Well, not so much.  In theory this all sounds very good.  Finally, we get an error response from the service, and some additional functionality.  But there are still two major issues with the protocol that you would discover very quickly if you decided to try and implement a client for it yourself:</p>

<ol>
<li><p>Apple never sends a response for messages that succeeded.</p></li>
<li><p>An error response may not immediately be returned before you have a chance to send more notifications to the stream, but before Apple closes the connection.  These notifications that might still â€˜make it throughâ€™ are left in limbo.  They are never acknowledged or delivered, and never have error responses returned for them.</p></li>
</ol>


<h3>How could Apple fix this?</h3>

<p>Remember how I told you to keep in mind the error response status code of â€˜0 â€“ No errors encounteredâ€™?  This is the silver bullet.  If Apple simply always returned an error response, for every notification, even if the notification succeeded, we could simply build a library that wrote a notification to the stream, waited for a response, and then moved onto the next notification, over and over.  Thereâ€™d be no business of waiting around for an error response that might never come, and greatly simplify the pains of implementing this protocol.  Apple might argue that this would consume more bandwidth, and while they may be right, in this day and age it would only amount to another ~6 MB per 1,000,000 notifications delivered.  Considering that Google and Windows Phone both use HTTP protocols and generate significantly more bandwidth based on the underlying protocol alone, and are able to keep their infrastructure running, an extra 6 bytes per notification should be pocket change to Apple in the cost of maybe a few additional servers and bandwidth allocation.</p>

<p>Itâ€™s such a simple answer.  Itâ€™s even in Appleâ€™s own documentation.  Yet, itâ€™s not our reality.</p>

<h3>So what is the workaround?</h3>

<p>Iâ€™ve looked at many libraries, written in many different languages, to see how they worked around this problem.  In about 99% of the cases Iâ€™ve observed, they all use the same, sadly inefficient approach: Waiting.</p>

<p>So again, we have a connection to Appleâ€™s APNS server, and we want to send notifications over that connection repeatedly, and as fast as possible.  Apple never sends us a response if a notification was sent successfully, but if one failed, they will send us an error response and close our connection.</p>

<p>The problem is, if we keep sending notifications over and over again, we might send a second, or third notification before Apple ever sends us an error response for the first one that failed.  If this happens, the second and third notifications are never delivered, and are lost forever.</p>

<p>The easiest way to solve this is to asynchronously read from the connection stream, waiting for an error response.  In doing so, however, this means you must also wait a little while after you write each notification to the stream to see if your asynchronous read ever receives anything.  You canâ€™t just do a synchronous blocking read on the stream since youâ€™d be waiting indefinitely if the notification succeeded (since Apple sends no response in this case).  To make matters worse, Apple doesnâ€™t guarantee how quickly an error response will be sent to us. Iâ€™ve seen libraries wait for an error response from anywhere between 100 to 500 milliseconds.</p>

<p>It should be painfully obvious to you by now why this approach is flawed.  If you have to wait even 100 milliseconds after sending every notification, that would take you almost 28 hours to send 1,000,000 notifications over a single connection!</p>

<p>Most libraries employ the use of multiple connections to circumvent this new issue theyâ€™ve created for themselves by waiting between each notification.  If you use 10 connections to appleâ€™s servers, that cuts your time down to 2.8 hours.  This is better, but why should it take 10 connections 2.8 hours to deliver a theoretical maximum of only 300MB of data (1,000,000 notifications * 301 bytes maximum size per notification)?  This is asinine!</p>

<h3>A better workaround</h3>

<p>I just couldnâ€™t stand the thought of wasting 100-500 milliseconds per notification sent.  I figured there had to be a better way, and I think Iâ€™ve found it!  PushSharp employs a technique that is fairly easy in theory, and was a bit more difficult to implement in code.</p>

<p>Each time a notification is written to the connection stream, it is then added to a â€˜Sentâ€™ queue.  If an error response is received, the corresponding notification is located in the â€˜Sentâ€™ queue (by its identifier).  Anything before the error-causing notification in the queue is removed and assumed to be successfully sent.  Anything after the error-causing notification is assumed to be lost, and re-queued to the â€˜To Sendâ€™ queue to be tried again.  There is also a cleanup thread running that constantly checks the oldest notification in the â€˜Sentâ€™ queue to see if itâ€™s older than a few seconds and if so, it is assumed to have been successfully sent and is removed from the â€˜Sentâ€™ queue.  This effectively moves the waiting period for an error response outside of the scope of the connection to the APNS servers.  The diagram below illustrates how the Sent queue works:</p>

<blockquote><p>PushSharp Sent Queue
<img src="http://redth.info/images/Problem-With-APNS/PushSharp-Sent-Queue.png" alt="" /></p></blockquote>

<h3>Conclusion</h3>

<p>So thatâ€™s it, thatâ€™s my big speech on why Appleâ€™s Push Notifications are so troublesome, how they could make my life a lot easier with a couple small changes, and how Iâ€™ve learned to cope with the situation for now.  I hope you enjoyed my ramble, and do please check out PushSharp!</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Using the Android Contact Picker with Xamarin.Mobile to Send an SMS in Mono for Android 4.0]]></title>
    <link href="http://redth.info/using-the-android-contact-picker-with-xamarin"/>
    <updated>2011-12-08T00:00:00-05:00</updated>
    <id>http://redth.info/using-the-android-contact-picker-with-xamarin.mobile</id>
    <content type="html"><![CDATA[<p>First and foremost: Xamarin has been doing an awesome job with their MonoTouch and Mono for Android product line!  Huge kudos to the entire team for allowing us some much needed obj-c and java mobile platform escapism!</p>

<p>If you don&#8217;t know about Xamarin, they are the company behind products allowing developers to write TRUELY NATIVE applications for Android and iOS in C#!  I honestly can&#8217;t say enough good things about these products, but you should check them out for yourself: http://xamarin.com</p>

<p>Onto the goodies.  If it wasn&#8217;t enough for us to be able to access native iOS and Android API&#8217;s via C#, Xamarin has gone ahead and started building a cross mobile platform set of libraries which aim to help us developers even more in creating sets of code to be reused on all the great mobile platforms.  You can check out more about this initiative here: http://blog.xamarin.com/2011/11/22/introducing-the-xamarin-mobile-api/</p>

<!-- more -->


<p>The latest preview version of Xamarin.Mobile just hit the intertubes, and I was keen to try it out as a replacement to some awful code I had to write to deal with the Android API&#8217;s for Contacts.  This latest preview now contains Contacts and Location API support for both MonoTouch and Mono for Android.  In the sample below, you can see some Android specific code, so I&#8217;m not truely writing cross platform code here, but with a bit of abstraction from the UI layer, this would be possible.  However, the purpose of this example is more to show you just how bleeping easy it is to work with Contacts in Mono for Android using Xamarin.Mobile!</p>

<p>It&#8217;s so simple I don&#8217;t even think it needs any explanation past the comments in the code I&#8217;ve provided!  Enjoy!</p>

<p>PS - A special thanks to @ermau who has been hard at work creating Xamarin.Mobile, and has been super helpful (how cliche of Xamarin folks!) in using it!</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class='csharp'><span class='line'><span class="k">void</span> <span class="nf">button_Click</span><span class="p">(</span><span class="kt">object</span> <span class="n">sender</span><span class="p">,</span> <span class="n">EventArgs</span> <span class="n">e</span><span class="p">)</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>  <span class="c1">//Create a new intent for choosing a contact</span>
</span><span class='line'>  <span class="kt">var</span> <span class="n">contactPickerIntent</span> <span class="p">=</span> <span class="k">new</span> <span class="n">Intent</span><span class="p">(</span><span class="n">Intent</span><span class="p">.</span><span class="n">ActionPick</span><span class="p">,</span>
</span><span class='line'>      <span class="n">Android</span><span class="p">.</span><span class="n">Provider</span><span class="p">.</span><span class="n">ContactsContract</span><span class="p">.</span><span class="n">Contacts</span><span class="p">.</span><span class="n">ContentUri</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'>  <span class="c1">//Start the contact picker expecting a result</span>
</span><span class='line'>  <span class="c1">// with the resultCode &#39;101&#39;</span>
</span><span class='line'>  <span class="n">StartActivityForResult</span><span class="p">(</span><span class="n">contactPickerIntent</span><span class="p">,</span> <span class="m">101</span><span class="p">);</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>




<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
</pre></td><td class='code'><pre><code class='csharp'><span class='line'><span class="k">public</span> <span class="k">override</span> <span class="k">void</span> <span class="nf">OnActivityResult</span><span class="p">(</span><span class="kt">int</span> <span class="n">requestCode</span><span class="p">,</span> <span class="n">Result</span> <span class="n">resultCode</span><span class="p">,</span> <span class="n">Intent</span> <span class="n">data</span><span class="p">)</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>  <span class="c1">//See if we are handling the contact picker request code</span>
</span><span class='line'>  <span class="c1">//  and that the result code is ok!</span>
</span><span class='line'>  <span class="k">if</span> <span class="p">(</span><span class="n">requestCode</span> <span class="p">==</span> <span class="m">101</span> <span class="p">&amp;&amp;</span> <span class="n">resultCode</span> <span class="p">==</span> <span class="n">Result</span><span class="p">.</span><span class="n">Ok</span><span class="p">)</span>
</span><span class='line'>  <span class="p">{</span>
</span><span class='line'>      <span class="c1">//Ensure we have data returned</span>
</span><span class='line'>      <span class="k">if</span> <span class="p">(</span><span class="n">data</span> <span class="p">==</span> <span class="k">null</span> <span class="p">||</span> <span class="n">data</span><span class="p">.</span><span class="n">Data</span> <span class="p">==</span> <span class="k">null</span><span class="p">)</span>
</span><span class='line'>          <span class="k">return</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>      <span class="c1">//Xamarin.Mobile code here :)</span>
</span><span class='line'>      <span class="kt">var</span> <span class="n">addressBook</span> <span class="p">=</span> <span class="k">new</span> <span class="n">Xamarin</span><span class="p">.</span><span class="n">Contacts</span><span class="p">.</span><span class="n">AddressBook</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
</span><span class='line'>      <span class="c1">//Note: This is important </span>
</span><span class='line'>      <span class="n">addressBook</span><span class="p">.</span><span class="n">PreferContactAggregation</span> <span class="p">=</span> <span class="k">true</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>      <span class="c1">//Load the contact via the android contact id</span>
</span><span class='line'>      <span class="c1">// in the last segment of the Uri returned by the </span>
</span><span class='line'>      <span class="c1">// android contact picker</span>
</span><span class='line'>      <span class="kt">var</span> <span class="n">contact</span> <span class="p">=</span> <span class="n">addressBook</span><span class="p">.</span><span class="n">Load</span><span class="p">(</span><span class="n">data</span><span class="p">.</span><span class="n">Data</span><span class="p">.</span><span class="n">LastPathSegment</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'>      <span class="c1">//Use linq to find a mobile number</span>
</span><span class='line'>      <span class="kt">var</span> <span class="n">mobile</span> <span class="p">=</span> <span class="p">(</span><span class="k">from</span> <span class="n">p</span> <span class="k">in</span> <span class="n">contact</span><span class="p">.</span><span class="n">Phones</span> <span class="k">where</span>
</span><span class='line'>                      <span class="n">p</span><span class="p">.</span><span class="n">Type</span> <span class="p">==</span> <span class="n">Xamarin</span><span class="p">.</span><span class="n">Contacts</span><span class="p">.</span><span class="n">PhoneType</span><span class="p">.</span><span class="n">Mobile</span>
</span><span class='line'>                      <span class="k">select</span> <span class="n">p</span><span class="p">.</span><span class="n">Number</span><span class="p">).</span><span class="n">FirstOrDefault</span><span class="p">();</span>
</span><span class='line'>
</span><span class='line'>      <span class="c1">//See if the contact has a mobile number</span>
</span><span class='line'>      <span class="k">if</span> <span class="p">(</span><span class="kt">string</span><span class="p">.</span><span class="n">IsNullOrEmpty</span><span class="p">(</span><span class="n">mobile</span><span class="p">))</span>
</span><span class='line'>      <span class="p">{</span>
</span><span class='line'>          <span class="n">Toast</span><span class="p">.</span><span class="n">MakeText</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="s">&quot;No Mobile Number for contact!&quot;</span><span class="p">,</span>
</span><span class='line'>              <span class="n">ToastLength</span><span class="p">.</span><span class="n">Short</span><span class="p">).</span><span class="n">Show</span><span class="p">();</span>
</span><span class='line'>          <span class="k">return</span><span class="p">;</span>
</span><span class='line'>      <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>      <span class="c1">//Send SMS!</span>
</span><span class='line'>      <span class="kt">var</span> <span class="n">smsMgr</span> <span class="p">=</span> <span class="n">Android</span><span class="p">.</span><span class="n">Telephony</span><span class="p">.</span><span class="n">SmsManager</span><span class="p">.</span><span class="n">Default</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>      <span class="n">smsMgr</span><span class="p">.</span><span class="n">SendTextMessage</span><span class="p">(</span><span class="n">mobile</span><span class="p">,</span> <span class="k">null</span><span class="p">,</span> <span class="s">&quot;Hello World!&quot;</span><span class="p">,</span> <span class="k">null</span><span class="p">,</span> <span class="k">null</span><span class="p">);</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Why we needed Facebook Messenger]]></title>
    <link href="http://redth.info/why-we-needed-facebook-messenger"/>
    <updated>2011-08-10T00:00:00-04:00</updated>
    <id>http://redth.info/why-we-needed-facebook-messenger</id>
    <content type="html"><![CDATA[<blockquote><p><img src="http://redth.info/images/FB-MSG/01.png" alt="" /></p></blockquote>

<p>So if you havenâ€™t heard yet, Facebook has come out with their own BBM slash iMessage slash Kik slash WhatsApp slash slash slashâ€¦  Oh great, another messenger app that we donâ€™t need?
I live in a world where Iâ€™m geeked out for every new gadget and service on the planet.  I sign up first, I play around with the service, and I daydream about how wonderful my life would be if all my friends got onboard and started using this newfangled, awesome, life altering service!  Unfortunately, thatâ€™s all just a daydream.</p>

<!-- more -->


<h3>My friends arenâ€™t all Geeks</h3>

<blockquote><p><img src="http://redth.info/images/FB-MSG/02.png" alt="" /></p></blockquote>

<p>In the real world, most of my friends donâ€™t care.  They are normal people, who can still sleep at night without a Google+ invite.  At the end of the day, if tech makes their life better, easier, or otherwise more fulfilling, they will use it.  If it doesnâ€™t meet these requirements, why should they care?  I canâ€™t disagree with this sentiment either looking at things from their perspective.  In fact Iâ€™ve made it a priority lately to not try and get all my family and friends using the latest and greatest new thing, or trying to get them to buy this device or that device.  Instead, Iâ€™m trying to practice restraint, and help them get what best suits THEIR needs, not my own desires projected onto their experiences.
I recently bit my tongue as my sister decided a blackberry was the best device for her, simply because her husband has one for work, and they could chat for free over BBM.  I tried to explain to her that data is data, and they could easily use WhatsApp or Google Talk to chat no matter which device she picked.  In the end, I realized BBM would just work for them.  It wouldnâ€™t matter if Whatsappâ€™s servers went down, or if her workâ€™s firewall would block WhatsApp, it would JUST WORK, period.</p>

<p>Messaging has long been a frustration for me.  I can remember at some points in my life having at least 5 or 6 different IM accounts running under Gaim (rockinâ€™ it old school) or Trillian or some other software as such.  Eventually most of my contacts seemed to stick to a couple main networks, and recently I have taken to only using Google Talk and Skype as my main messaging platforms.</p>

<h3>Mobile: This changes everything</h3>

<p>As mobile came along, the game changed again.  Eventually it became universal that everyone should have texting capabilities.  This has been pretty good, but recently texting has become more and more frustrating for a number of reasons:</p>

<ol>
<li><p><strong><em>Itâ€™s not necessarily cheap.</em></strong>  Phone companies love to charge outrageous amounts for a service which essentially costs them nothing.  For shame.</p></li>
<li><p><strong><em>Itâ€™s not reliable.</em></strong>  In Canada we have 3 major networks: Rogers, Bell, Telus.  Usually sending messages within the same network is fairly reliable (although recently it took 3 hours for a text to arrive from my wife, we sat in the same room and watched it happen).  Unfortunately my friends are on different networks and we have nothing but problems with texts being delayed for hours, or never reaching their destination
at all.  This problem seems to be amplified on weekends, when reliability is most critical.  The carriers all like to pass the buck to each other on this issue.</p></li>
<li><p><strong><em>Itâ€™s not cross-platform / cross-device.</em></strong>  If Iâ€™m sitting at a computer, with a full keyboard, why the heck would I want to type a message on my phone? I shouldnâ€™t have to shift between SMS and GTalk just because Iâ€™m moving between devices.</p></li>
</ol>


<h3>Data for the masses:  This changes everything.  Again.</h3>

<blockquote><p><img src="http://redth.info/images/FB-MSG/03.png" alt="" /></p></blockquote>

<p>Data has become fairly ubiquitous now for mobile users.  Almost all of my close friends have smartphones, and most of them have some sort of data plan.  Companies such as Kik or WhatsApp have tried to stick it to the man by making applications that replace traditional SMSâ€™ing which use data instead of SMS.  Theyâ€™re better, stronger, faster, and usually more reliable (or at least as reliable as Amazonâ€™s cloud services).
These applications are great.  Iâ€™ve even got some of my friends using them, and why not?  They seem to be more reliable, and have better features (like not having to pay $0.25 to send a picture!).  This fixes the problems of Reliability and Price, but it introduces a new problem: Ubiquity.  Check out this compatibility matrix, there is not one data based messenger app that covers all platforms.  How can I expect to get all my friends on board with this?</p>

<blockquote><p><img src="http://redth.info/images/FB-MSG/table.png" alt="" /></p></blockquote>

<p>Even if one app covered all the platforms, thereâ€™s still the difficulty of getting friend buy-in.  They need to get the app, register, and start using it.  Not an easy feat.  Plus, Iâ€™d still be stuck using SMS for the few friends still without data plans or smartphones.  This scenario would be better, but not perfect.</p>

<h3>Your mom is on facebook</h3>

<blockquote><p><img src="http://redth.info/images/FB-MSG/04.png" alt="" /></p></blockquote>

<p>And your aunt, and your grandma!  Seriously, facebook has taken the world by storm.  Itâ€™s like one of those geek daydreams that actually came true, where ALL my friends actually signed up for and used the new geeky service (ok thereâ€™s a few stragglers and defiant friends, but heck, itâ€™s their loss!).</p>

<p>Letâ€™s talk about ubiquity here.  All my friends are already registered for facebook .  Check!  Facebook Messenger supports iOS and Android, and according to a very small blurb in their help center, Blackberry support is coming soon.  Iâ€™d also be extremely surprised if we did not see a Windows Phone 7 app released when Mango is officially out in the wild.  That leaves Nokia and Meego.  Now, to be fair, a lot of people outside of North America may still use Nokia.  In my world, nobody with a smartphone has anything other than iOS, Android, or Blackberry (Iâ€™m the only person I know who owns a WP7 device even).</p>

<p>In my world, once the Blackberry app is released, all my friends (who have smartphones and data plans) have no excuse not to use Facebook Messenger.  In addition, all my friends who text can still be included, as the Facebook Messenger creators were smart enough to incorporate the ability to include normal SMS numbers in your chats.  That means ideally, I still have to go into one app only to communicate with all my friends.
Finally, Facebook Messenger integrates with Facebook Messages and Chat on the regular website.  I can finally transition from my desktop, to my phone, to my iPad, and back to my desktop seamlessly, without my friends knowing any different, and without losing my conversation history.  This is a big win for me!</p>

<blockquote><p><img src="http://redth.info/images/FB-MSG/05.png" alt="" /></p></blockquote>

<h3>Ok Fanboy, settle down!</h3>

<p>Honestly, Iâ€™m not trying to be a fanboy.  I donâ€™t even like facebook as a company that much, but I canâ€™t help but love the possibilities that facebook messenger brings to my world.  If I can get my friends on board (and I donâ€™t think it will be an issue), we can finally chat reliably, seamlessly, for less money!  Good bye SMS plan!</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[MonoDroid - Custom ListAdapter for your ListView]]></title>
    <link href="http://redth.info/2010/10/12/monodroid-custom-listadapter-for-your-listview"/>
    <updated>2010-05-13T00:00:00-04:00</updated>
    <id>http://redth.info/2010/10/12/monodroid-custom-listadapter-for-your-listview</id>
    <content type="html"><![CDATA[<p>I donâ€™t know about you, but the main thing Iâ€™m interested in on any new mobile development platform for some reason, is LISTS. I think Iâ€™m so fixated on lists is because of the way the iPhone so successfully introduced the paradigm of list based navigation. Everything can be done in a series of lists (ok not really, but they are crucial to many apps!).</p>

<blockquote><p><img src="http://redth.info/images/MonoDroid-Custom-ListAdapter/CustomList.png" alt="" /></p></blockquote>

<p>Naturally then, the first thing I sought out to do on MonoDroid was to create a list. Easy, piece of cakeâ€¦ If you want to create a boring old list with a single line of text for each item. This is no doubt, an important part of every developerâ€™s Hello World development phase, but it doesnâ€™t take long before youâ€™re craving images, several text elements, and possibly even some checkboxes and/or buttons (easy there tiger). For every ListView in Android, there is a prince charming Listview Adapter to save the day.</p>

<!-- more -->


<p>The most basic of examples which youâ€™ve no doubt seen involve an ArrayAdapter of some sort, with the default <em>Android.R.Layout.SimpleListItem</em> or whatever it is called. BOOORING. What we need to do to make something exciting is create our own custom ListView Adapter. Now, you could use a SimpleAdapter to map fields to certain resource idâ€™s of a layout, but if you look at a java example of this, â€˜Simpleâ€™ quickly becomes a relative term. What I like to do is create my own adapter deriving from the BaseAdapter class (how fitting).</p>

<p>Hereâ€™s some code for my custom list adapter (explanation to follow):</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
<span class='line-number'>57</span>
<span class='line-number'>58</span>
<span class='line-number'>59</span>
<span class='line-number'>60</span>
<span class='line-number'>61</span>
<span class='line-number'>62</span>
<span class='line-number'>63</span>
<span class='line-number'>64</span>
<span class='line-number'>65</span>
<span class='line-number'>66</span>
<span class='line-number'>67</span>
<span class='line-number'>68</span>
<span class='line-number'>69</span>
<span class='line-number'>70</span>
<span class='line-number'>71</span>
<span class='line-number'>72</span>
<span class='line-number'>73</span>
<span class='line-number'>74</span>
<span class='line-number'>75</span>
<span class='line-number'>76</span>
<span class='line-number'>77</span>
<span class='line-number'>78</span>
<span class='line-number'>79</span>
<span class='line-number'>80</span>
<span class='line-number'>81</span>
<span class='line-number'>82</span>
<span class='line-number'>83</span>
<span class='line-number'>84</span>
<span class='line-number'>85</span>
<span class='line-number'>86</span>
<span class='line-number'>87</span>
<span class='line-number'>88</span>
<span class='line-number'>89</span>
<span class='line-number'>90</span>
<span class='line-number'>91</span>
<span class='line-number'>92</span>
<span class='line-number'>93</span>
<span class='line-number'>94</span>
<span class='line-number'>95</span>
<span class='line-number'>96</span>
</pre></td><td class='code'><pre><code class='csharp'><span class='line'><span class="k">using</span> <span class="nn">System</span><span class="p">;</span>
</span><span class='line'><span class="k">using</span> <span class="nn">System.Collections.Generic</span><span class="p">;</span>
</span><span class='line'><span class="k">using</span> <span class="nn">System.Linq</span><span class="p">;</span>
</span><span class='line'><span class="k">using</span> <span class="nn">System.Text</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'><span class="k">using</span> <span class="nn">Android.App</span><span class="p">;</span>
</span><span class='line'><span class="k">using</span> <span class="nn">Android.Content</span><span class="p">;</span>
</span><span class='line'><span class="k">using</span> <span class="nn">Android.OS</span><span class="p">;</span>
</span><span class='line'><span class="k">using</span> <span class="nn">Android.Runtime</span><span class="p">;</span>
</span><span class='line'><span class="k">using</span> <span class="nn">Android.Views</span><span class="p">;</span>
</span><span class='line'><span class="k">using</span> <span class="nn">Android.Widget</span><span class="p">;</span>
</span><span class='line'><span class="k">using</span> <span class="nn">Android.Graphics.Drawables</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'><span class="k">namespace</span> <span class="nn">MonoDroid.CustomList</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>  <span class="k">public</span> <span class="k">class</span> <span class="nc">CustomListAdapter</span> <span class="p">:</span> <span class="n">BaseAdapter</span>
</span><span class='line'>  <span class="p">{</span>
</span><span class='line'>      <span class="n">Activity</span> <span class="n">context</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>      <span class="k">public</span> <span class="n">List</span><span class="p">&lt;</span><span class="n">Animal</span><span class="p">&gt;</span> <span class="n">items</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>      <span class="k">public</span> <span class="nf">CustomListAdapter</span><span class="p">(</span><span class="n">Activity</span> <span class="n">context</span><span class="p">)</span> <span class="c1">//We need a context to inflate our row view from</span>
</span><span class='line'>          <span class="p">:</span> <span class="k">base</span><span class="p">()</span>
</span><span class='line'>      <span class="p">{</span>
</span><span class='line'>          <span class="k">this</span><span class="p">.</span><span class="n">context</span> <span class="p">=</span> <span class="n">context</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>          <span class="c1">//For demo purposes we hard code some data here</span>
</span><span class='line'>          <span class="k">this</span><span class="p">.</span><span class="n">items</span> <span class="p">=</span> <span class="k">new</span> <span class="n">List</span><span class="p">&lt;</span><span class="n">Animal</span><span class="p">&gt;()</span> <span class="p">{</span>
</span><span class='line'>              <span class="k">new</span> <span class="nf">Animal</span><span class="p">()</span> <span class="p">{</span> <span class="n">Name</span> <span class="p">=</span> <span class="s">&quot;Elephant&quot;</span><span class="p">,</span> <span class="n">Description</span> <span class="p">=</span> <span class="s">&quot;Big and Gray, but what the hey&quot;</span><span class="p">,</span> <span class="n">Image</span> <span class="p">=</span> <span class="n">Resource</span><span class="p">.</span><span class="n">drawable</span><span class="p">.</span><span class="n">elephant</span> <span class="p">},</span>
</span><span class='line'>              <span class="k">new</span> <span class="nf">Animal</span><span class="p">()</span> <span class="p">{</span> <span class="n">Name</span> <span class="p">=</span> <span class="s">&quot;Chinchilla&quot;</span><span class="p">,</span> <span class="n">Description</span> <span class="p">=</span> <span class="s">&quot;Little people of the andes&quot;</span><span class="p">,</span> <span class="n">Image</span> <span class="p">=</span> <span class="n">Resource</span><span class="p">.</span><span class="n">drawable</span><span class="p">.</span><span class="n">chinchilla</span> <span class="p">},</span>
</span><span class='line'>              <span class="k">new</span> <span class="nf">Animal</span><span class="p">()</span> <span class="p">{</span> <span class="n">Name</span> <span class="p">=</span> <span class="s">&quot;Lion&quot;</span><span class="p">,</span> <span class="n">Description</span> <span class="p">=</span> <span class="s">&quot;Cowardly lion, anyone?&quot;</span><span class="p">,</span> <span class="n">Image</span> <span class="p">=</span> <span class="n">Resource</span><span class="p">.</span><span class="n">drawable</span><span class="p">.</span><span class="n">lion</span> <span class="p">},</span>
</span><span class='line'>              <span class="k">new</span> <span class="nf">Animal</span><span class="p">()</span> <span class="p">{</span> <span class="n">Name</span> <span class="p">=</span> <span class="s">&quot;Skunk&quot;</span><span class="p">,</span> <span class="n">Description</span> <span class="p">=</span> <span class="s">&quot;Ello, baby. I am ze locksmith of love, no?&quot;</span><span class="p">,</span> <span class="n">Image</span> <span class="p">=</span> <span class="n">Resource</span><span class="p">.</span><span class="n">drawable</span><span class="p">.</span><span class="n">skunk</span> <span class="p">},</span>
</span><span class='line'>              <span class="k">new</span> <span class="nf">Animal</span><span class="p">()</span> <span class="p">{</span> <span class="n">Name</span> <span class="p">=</span> <span class="s">&quot;Rhino&quot;</span><span class="p">,</span> <span class="n">Description</span> <span class="p">=</span> <span class="s">&quot;Most live to about 60, pretty old eh?&quot;</span><span class="p">,</span> <span class="n">Image</span> <span class="p">=</span> <span class="n">Resource</span><span class="p">.</span><span class="n">drawable</span><span class="p">.</span><span class="n">rhino</span> <span class="p">},</span>
</span><span class='line'>              <span class="k">new</span> <span class="nf">Animal</span><span class="p">()</span> <span class="p">{</span> <span class="n">Name</span> <span class="p">=</span> <span class="s">&quot;Zebra&quot;</span><span class="p">,</span> <span class="n">Description</span> <span class="p">=</span> <span class="s">&quot;Stripes maybe not so great for hiding&quot;</span><span class="p">,</span> <span class="n">Image</span> <span class="p">=</span> <span class="n">Resource</span><span class="p">.</span><span class="n">drawable</span><span class="p">.</span><span class="n">zebra</span> <span class="p">},</span>
</span><span class='line'>              <span class="k">new</span> <span class="nf">Animal</span><span class="p">()</span> <span class="p">{</span> <span class="n">Name</span> <span class="p">=</span> <span class="s">&quot;Squirrel&quot;</span><span class="p">,</span> <span class="n">Description</span> <span class="p">=</span> <span class="s">&quot;Nuts nuts, where&#39;s my nuts?!&quot;</span><span class="p">,</span> <span class="n">Image</span> <span class="p">=</span> <span class="n">Resource</span><span class="p">.</span><span class="n">drawable</span><span class="p">.</span><span class="n">squirrel</span> <span class="p">},</span>
</span><span class='line'>              <span class="k">new</span> <span class="nf">Animal</span><span class="p">()</span> <span class="p">{</span> <span class="n">Name</span> <span class="p">=</span> <span class="s">&quot;Walrus&quot;</span><span class="p">,</span> <span class="n">Description</span> <span class="p">=</span> <span class="s">&quot;I am he as you are he as you are me&quot;</span><span class="p">,</span> <span class="n">Image</span> <span class="p">=</span> <span class="n">Resource</span><span class="p">.</span><span class="n">drawable</span><span class="p">.</span><span class="n">walrus</span> <span class="p">},</span>
</span><span class='line'>              <span class="k">new</span> <span class="nf">Animal</span><span class="p">()</span> <span class="p">{</span> <span class="n">Name</span> <span class="p">=</span> <span class="s">&quot;Giraffe&quot;</span><span class="p">,</span> <span class="n">Description</span> <span class="p">=</span> <span class="s">&quot;Bigger than your ford pinto&quot;</span><span class="p">,</span> <span class="n">Image</span> <span class="p">=</span> <span class="n">Resource</span><span class="p">.</span><span class="n">drawable</span><span class="p">.</span><span class="n">giraffe</span> <span class="p">},</span>
</span><span class='line'>              <span class="k">new</span> <span class="nf">Animal</span><span class="p">()</span> <span class="p">{</span> <span class="n">Name</span> <span class="p">=</span> <span class="s">&quot;Chicken&quot;</span><span class="p">,</span> <span class="n">Description</span> <span class="p">=</span> <span class="s">&quot;I&#39;ll take 2 eggs over easy&quot;</span><span class="p">,</span> <span class="n">Image</span> <span class="p">=</span> <span class="n">Resource</span><span class="p">.</span><span class="n">drawable</span><span class="p">.</span><span class="n">chicken</span> <span class="p">},</span>
</span><span class='line'>              <span class="k">new</span> <span class="nf">Animal</span><span class="p">()</span> <span class="p">{</span> <span class="n">Name</span> <span class="p">=</span> <span class="s">&quot;Duck&quot;</span><span class="p">,</span> <span class="n">Description</span> <span class="p">=</span> <span class="s">&quot;He&#39;s all quacked up&quot;</span><span class="p">,</span> <span class="n">Image</span> <span class="p">=</span> <span class="n">Resource</span><span class="p">.</span><span class="n">drawable</span><span class="p">.</span><span class="n">duck</span> <span class="p">},</span>
</span><span class='line'>              <span class="k">new</span> <span class="nf">Animal</span><span class="p">()</span> <span class="p">{</span> <span class="n">Name</span> <span class="p">=</span> <span class="s">&quot;Hawk&quot;</span><span class="p">,</span> <span class="n">Description</span> <span class="p">=</span> <span class="s">&quot;He needs to be on a t-shirt&quot;</span><span class="p">,</span> <span class="n">Image</span> <span class="p">=</span> <span class="n">Resource</span><span class="p">.</span><span class="n">drawable</span><span class="p">.</span><span class="n">hawk</span> <span class="p">},</span>
</span><span class='line'>              <span class="k">new</span> <span class="nf">Animal</span><span class="p">()</span> <span class="p">{</span> <span class="n">Name</span> <span class="p">=</span> <span class="s">&quot;Lobster&quot;</span><span class="p">,</span> <span class="n">Description</span> <span class="p">=</span> <span class="s">&quot;We were at the beach...&quot;</span><span class="p">,</span> <span class="n">Image</span> <span class="p">=</span> <span class="n">Resource</span><span class="p">.</span><span class="n">drawable</span><span class="p">.</span><span class="n">lobster</span> <span class="p">},</span>
</span><span class='line'>              <span class="k">new</span> <span class="nf">Animal</span><span class="p">()</span> <span class="p">{</span> <span class="n">Name</span> <span class="p">=</span> <span class="s">&quot;Pig&quot;</span><span class="p">,</span> <span class="n">Description</span> <span class="p">=</span> <span class="s">&quot;Babe, Orson, Piglet, whatever&quot;</span><span class="p">,</span> <span class="n">Image</span> <span class="p">=</span> <span class="n">Resource</span><span class="p">.</span><span class="n">drawable</span><span class="p">.</span><span class="n">pig</span> <span class="p">},</span>
</span><span class='line'>              <span class="k">new</span> <span class="nf">Animal</span><span class="p">()</span> <span class="p">{</span> <span class="n">Name</span> <span class="p">=</span> <span class="s">&quot;Rabbit&quot;</span><span class="p">,</span> <span class="n">Description</span> <span class="p">=</span> <span class="s">&quot;Thumper is the best rabbit name ever&quot;</span><span class="p">,</span> <span class="n">Image</span> <span class="p">=</span> <span class="n">Resource</span><span class="p">.</span><span class="n">drawable</span><span class="p">.</span><span class="n">rabbit</span> <span class="p">},</span>
</span><span class='line'>              <span class="k">new</span> <span class="nf">Animal</span><span class="p">()</span> <span class="p">{</span> <span class="n">Name</span> <span class="p">=</span> <span class="s">&quot;Turtle&quot;</span><span class="p">,</span> <span class="n">Description</span> <span class="p">=</span> <span class="s">&quot;Slow and steady wins the race&quot;</span><span class="p">,</span> <span class="n">Image</span> <span class="p">=</span> <span class="n">Resource</span><span class="p">.</span><span class="n">drawable</span><span class="p">.</span><span class="n">turtle</span> <span class="p">},</span>
</span><span class='line'>          <span class="p">};</span>
</span><span class='line'>      <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>      <span class="k">public</span> <span class="k">override</span> <span class="kt">int</span> <span class="n">Count</span>
</span><span class='line'>      <span class="p">{</span>
</span><span class='line'>          <span class="k">get</span> <span class="p">{</span> <span class="k">return</span> <span class="n">items</span><span class="p">.</span><span class="n">Count</span><span class="p">;</span> <span class="p">}</span>
</span><span class='line'>      <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>      <span class="k">public</span> <span class="k">override</span> <span class="n">Java</span><span class="p">.</span><span class="n">Lang</span><span class="p">.</span><span class="n">Object</span> <span class="n">GetItem</span><span class="p">(</span><span class="kt">int</span> <span class="n">position</span><span class="p">)</span>
</span><span class='line'>      <span class="p">{</span>
</span><span class='line'>          <span class="k">return</span> <span class="n">position</span><span class="p">;</span>
</span><span class='line'>      <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>      <span class="k">public</span> <span class="k">override</span> <span class="kt">long</span> <span class="nf">GetItemId</span><span class="p">(</span><span class="kt">int</span> <span class="n">position</span><span class="p">)</span>
</span><span class='line'>      <span class="p">{</span>
</span><span class='line'>          <span class="k">return</span> <span class="n">position</span><span class="p">;</span>
</span><span class='line'>      <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>      <span class="k">public</span> <span class="k">override</span> <span class="n">View</span> <span class="nf">GetView</span><span class="p">(</span><span class="kt">int</span> <span class="n">position</span><span class="p">,</span> <span class="n">View</span> <span class="n">convertView</span><span class="p">,</span> <span class="n">ViewGroup</span> <span class="n">parent</span><span class="p">)</span>
</span><span class='line'>      <span class="p">{</span>
</span><span class='line'>          <span class="c1">//Get our object for this position</span>
</span><span class='line'>          <span class="kt">var</span> <span class="n">item</span> <span class="p">=</span> <span class="n">items</span><span class="p">[</span><span class="n">position</span><span class="p">];</span>           
</span><span class='line'>
</span><span class='line'>          <span class="c1">//Try to reuse convertView if it&#39;s not  null, otherwise inflate it from our item layout</span>
</span><span class='line'>          <span class="c1">// This gives us some performance gains by not always inflating a new view</span>
</span><span class='line'>          <span class="c1">// This will sound familiar to MonoTouch developers with UITableViewCell.DequeueReusableCell()</span>
</span><span class='line'>          <span class="kt">var</span> <span class="n">view</span> <span class="p">=</span> <span class="p">(</span><span class="n">convertView</span> <span class="p">??</span>
</span><span class='line'>              <span class="n">context</span><span class="p">.</span><span class="n">LayoutInflater</span><span class="p">.</span><span class="n">Inflate</span><span class="p">(</span>
</span><span class='line'>                  <span class="n">Resource</span><span class="p">.</span><span class="n">layout</span><span class="p">.</span><span class="n">customlistitem</span><span class="p">,</span>
</span><span class='line'>                  <span class="n">parent</span><span class="p">,</span>
</span><span class='line'>                  <span class="k">false</span><span class="p">))</span> <span class="k">as</span> <span class="n">LinearLayout</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>          <span class="c1">//Find references to each subview in the list item&#39;s view</span>
</span><span class='line'>          <span class="kt">var</span> <span class="n">imageItem</span> <span class="p">=</span> <span class="n">view</span><span class="p">.</span><span class="n">FindViewById</span><span class="p">(</span><span class="n">Resource</span><span class="p">.</span><span class="n">id</span><span class="p">.</span><span class="n">imageItem</span><span class="p">)</span> <span class="k">as</span> <span class="n">ImageView</span><span class="p">;</span>
</span><span class='line'>          <span class="kt">var</span> <span class="n">textTop</span> <span class="p">=</span> <span class="n">view</span><span class="p">.</span><span class="n">FindViewById</span><span class="p">(</span><span class="n">Resource</span><span class="p">.</span><span class="n">id</span><span class="p">.</span><span class="n">textTop</span><span class="p">)</span> <span class="k">as</span> <span class="n">TextView</span><span class="p">;</span>
</span><span class='line'>          <span class="kt">var</span> <span class="n">textBottom</span> <span class="p">=</span> <span class="n">view</span><span class="p">.</span><span class="n">FindViewById</span><span class="p">(</span><span class="n">Resource</span><span class="p">.</span><span class="n">id</span><span class="p">.</span><span class="n">textBottom</span><span class="p">)</span> <span class="k">as</span> <span class="n">TextView</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>          <span class="c1">//Assign this item&#39;s values to the various subviews</span>
</span><span class='line'>          <span class="n">imageItem</span><span class="p">.</span><span class="n">SetImageResource</span><span class="p">(</span><span class="n">item</span><span class="p">.</span><span class="n">Image</span><span class="p">);</span>
</span><span class='line'>          <span class="n">textTop</span><span class="p">.</span><span class="n">SetText</span><span class="p">(</span><span class="n">item</span><span class="p">.</span><span class="n">Name</span><span class="p">,</span> <span class="n">TextView</span><span class="p">.</span><span class="n">BufferType</span><span class="p">.</span><span class="n">Normal</span><span class="p">);</span>
</span><span class='line'>          <span class="n">textBottom</span><span class="p">.</span><span class="n">SetText</span><span class="p">(</span><span class="n">item</span><span class="p">.</span><span class="n">Description</span><span class="p">,</span> <span class="n">TextView</span><span class="p">.</span><span class="n">BufferType</span><span class="p">.</span><span class="n">Normal</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'>          <span class="c1">//Finally return the view</span>
</span><span class='line'>          <span class="k">return</span> <span class="n">view</span><span class="p">;</span>
</span><span class='line'>      <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>      <span class="k">public</span> <span class="n">Animal</span> <span class="nf">GetItemAtPosition</span><span class="p">(</span><span class="kt">int</span> <span class="n">position</span><span class="p">)</span>
</span><span class='line'>      <span class="p">{</span>
</span><span class='line'>          <span class="k">return</span> <span class="n">items</span><span class="p">[</span><span class="n">position</span><span class="p">];</span>
</span><span class='line'>      <span class="p">}</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>Oh, and hereâ€™s the Animal class if youâ€™re curious:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
</pre></td><td class='code'><pre><code class='csharp'><span class='line'><span class="k">namespace</span> <span class="nn">MonoDroid.CustomList</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>  <span class="k">public</span> <span class="k">class</span> <span class="nc">Animal</span>
</span><span class='line'>  <span class="p">{</span>
</span><span class='line'>      <span class="k">public</span> <span class="kt">string</span> <span class="n">Name</span>
</span><span class='line'>      <span class="p">{</span>
</span><span class='line'>          <span class="k">get</span><span class="p">;</span>
</span><span class='line'>          <span class="k">set</span><span class="p">;</span>
</span><span class='line'>      <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>      <span class="k">public</span> <span class="kt">string</span> <span class="n">Description</span>
</span><span class='line'>      <span class="p">{</span>
</span><span class='line'>          <span class="k">get</span><span class="p">;</span>
</span><span class='line'>          <span class="k">set</span><span class="p">;</span>
</span><span class='line'>      <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>      <span class="k">public</span> <span class="kt">int</span> <span class="n">Image</span>
</span><span class='line'>      <span class="p">{</span>
</span><span class='line'>          <span class="k">get</span><span class="p">;</span>
</span><span class='line'>          <span class="k">set</span><span class="p">;</span>
</span><span class='line'>      <span class="p">}</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>Now for the sake of the demo, I create my own data inside the adapter, and of course nothing is stopping you from getting that data from a webservice, or somewhere more fashionable. The first thing to note is that Iâ€™m requiring an Activity object in the <em>ctor</em>. This really is only used to get the <em>LayoutInflator</em> for the given Activity so that we can inflate our rowâ€™s View later on, but it is important to have it. Next thing of interest is the overrides. All we really need to override is the <em>Count</em> property, <em>GetItem</em> method, <em>GetItemId</em> method, and <em>GetView</em> method. The last method (<em>GetItemAtPosition</em>) is my own addition so that I can read out the object for a given position elsewhere in the project (in this case, when a <em>ListView.ItemClicked</em> event is fired).</p>

<p><em>Count</em> is easy, just return your object listâ€™s count (duh). <em>GetItem</em> and <em>GetItemId</em> Iâ€™m still not convinced are necessary, but I override them anyways and just return the position in each case. The only significance I know of so far with these properties is in some ListView events, the item Id is passed as an event arg. However, in these same events, we also get the itemâ€™s position, which is why I have the <em>GetItemAtPosition</em> method, so I can retrieve the relevant object for the event. Iâ€™d love to hear from anyone who knows more about why I might want to pay more attention to the GetItem and <em>GetItemId</em> methods.</p>

<p><em>GetView</em> is where the magic happens. Basically, I get the item for the given position first. Next, I determine if the <em>convertView</em> parameter is null or not, and inflate my CustomListItemâ€™s layout into a usable View (<em>LinearLayout</em> to be specific). This is basically a way for us to reuse resources. Anyone familiar with MonoTouch and the Reusable <em>UITableViewCell</em> will feel right at home here. We could inflate the resource every time, but that would waste unnecessary resources. So, best practice here is to always reuse if the <em>convertView</em> is not null. Now then, with my <em>LinearLayout</em> instance, I can locate all of the views within that I want to assign information to, for the given row. As you can see in this case, I have an <em>ImageView</em>, and two <em>TextView</em>â€™s.</p>

<p>Here is what the layout xml looks like for my custom list item:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
</pre></td><td class='code'><pre><code class='xml'><span class='line'><span class="cp">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span>
</span><span class='line'><span class="nt">&lt;LinearLayout</span> <span class="na">xmlns:android=</span><span class="s">&quot;http://schemas.android.com/apk/res/android&quot;</span>
</span><span class='line'>  <span class="na">android:id=</span><span class="s">&quot;@+id/widget28&quot;</span>
</span><span class='line'>  <span class="na">android:layout_width=</span><span class="s">&quot;fill_parent&quot;</span>
</span><span class='line'>  <span class="na">android:layout_height=</span><span class="s">&quot;80px&quot;</span>
</span><span class='line'><span class="nt">&gt;</span>
</span><span class='line'>  <span class="nt">&lt;ImageView</span>
</span><span class='line'>  <span class="na">android:id=</span><span class="s">&quot;@+id/imageItem&quot;</span>
</span><span class='line'>  <span class="na">android:layout_width=</span><span class="s">&quot;wrap_content&quot;</span>
</span><span class='line'>  <span class="na">android:layout_height=</span><span class="s">&quot;wrap_content&quot;</span>
</span><span class='line'>  <span class="na">android:layout_gravity=</span><span class="s">&quot;center_vertical&quot;</span>
</span><span class='line'>      <span class="nt">&gt;</span>
</span><span class='line'>  <span class="nt">&lt;/ImageView&gt;</span>
</span><span class='line'>  <span class="nt">&lt;LinearLayout</span>
</span><span class='line'>  <span class="na">android:id=</span><span class="s">&quot;@+id/linearText&quot;</span>
</span><span class='line'>  <span class="na">android:layout_width=</span><span class="s">&quot;wrap_content&quot;</span>
</span><span class='line'>  <span class="na">android:layout_height=</span><span class="s">&quot;fill_parent&quot;</span>
</span><span class='line'>  <span class="na">android:orientation=</span><span class="s">&quot;vertical&quot;</span>
</span><span class='line'>  <span class="na">android:layout_marginLeft=</span><span class="s">&quot;10px&quot;</span>
</span><span class='line'>  <span class="na">android:layout_marginTop=</span><span class="s">&quot;10px&quot;</span>
</span><span class='line'>      <span class="nt">&gt;</span>
</span><span class='line'>      <span class="nt">&lt;TextView</span>
</span><span class='line'>      <span class="na">android:id=</span><span class="s">&quot;@+id/textTop&quot;</span>
</span><span class='line'>      <span class="na">android:layout_width=</span><span class="s">&quot;wrap_content&quot;</span>
</span><span class='line'>      <span class="na">android:layout_height=</span><span class="s">&quot;wrap_content&quot;</span>
</span><span class='line'>      <span class="na">android:text=</span><span class="s">&quot;TextView&quot;</span>
</span><span class='line'>          <span class="nt">&gt;</span>
</span><span class='line'>      <span class="nt">&lt;/TextView&gt;</span>
</span><span class='line'>      <span class="nt">&lt;TextView</span>
</span><span class='line'>      <span class="na">android:id=</span><span class="s">&quot;@+id/textBottom&quot;</span>
</span><span class='line'>      <span class="na">android:layout_width=</span><span class="s">&quot;wrap_content&quot;</span>
</span><span class='line'>      <span class="na">android:layout_height=</span><span class="s">&quot;wrap_content&quot;</span>
</span><span class='line'>      <span class="na">android:text=</span><span class="s">&quot;TextView&quot;</span>
</span><span class='line'>          <span class="nt">&gt;</span>
</span><span class='line'>      <span class="nt">&lt;/TextView&gt;</span>
</span><span class='line'>  <span class="nt">&lt;/LinearLayout&gt;</span>
</span><span class='line'><span class="nt">&lt;/LinearLayout&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<p>Once I have found references to these, I can set their text and image. Finally, I can return the <em>LinearLayout</em> View that Iâ€™ve been working on for this row. That wasnâ€™t so hard, was it? Last, but not least, we need to actually deal with our <em>Activity</em> that holds the <em>ListView</em>. Up until now we had just created the adapter that our <em>ListView</em> was going to use. Now we need to actually hook an adaptaâ€™ up.</p>

<p>Hereâ€™s what my Activity code looks like:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
</pre></td><td class='code'><pre><code class='csharp'><span class='line'><span class="k">using</span> <span class="nn">System</span><span class="p">;</span>
</span><span class='line'><span class="k">using</span> <span class="nn">Android.App</span><span class="p">;</span>
</span><span class='line'><span class="k">using</span> <span class="nn">Android.Content</span><span class="p">;</span>
</span><span class='line'><span class="k">using</span> <span class="nn">Android.Runtime</span><span class="p">;</span>
</span><span class='line'><span class="k">using</span> <span class="nn">Android.Views</span><span class="p">;</span>
</span><span class='line'><span class="k">using</span> <span class="nn">Android.Widget</span><span class="p">;</span>
</span><span class='line'><span class="k">using</span> <span class="nn">Android.OS</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'><span class="k">namespace</span> <span class="nn">MonoDroid.CustomList</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'><span class="na"> [Activity(Label = &quot;1 CustomList&quot;, MainLauncher = true)]</span>
</span><span class='line'>  <span class="k">public</span> <span class="k">class</span> <span class="nc">CustomList</span> <span class="p">:</span> <span class="n">Activity</span>
</span><span class='line'>  <span class="p">{</span>
</span><span class='line'>      <span class="n">CustomListAdapter</span> <span class="n">listAdapter</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>      <span class="k">public</span> <span class="nf">CustomList</span><span class="p">(</span><span class="n">IntPtr</span> <span class="n">handle</span><span class="p">)</span>
</span><span class='line'>          <span class="p">:</span> <span class="k">base</span><span class="p">(</span><span class="n">handle</span><span class="p">)</span>
</span><span class='line'>      <span class="p">{</span>
</span><span class='line'>      <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>      <span class="k">protected</span> <span class="k">override</span> <span class="k">void</span> <span class="nf">OnCreate</span><span class="p">(</span><span class="n">Bundle</span> <span class="n">bundle</span><span class="p">)</span>
</span><span class='line'>      <span class="p">{</span>
</span><span class='line'>          <span class="k">base</span><span class="p">.</span><span class="n">OnCreate</span><span class="p">(</span><span class="n">bundle</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'>          <span class="c1">//Set the Activity&#39;s view to our list layout       </span>
</span><span class='line'>          <span class="n">SetContentView</span><span class="p">(</span><span class="n">Resource</span><span class="p">.</span><span class="n">layout</span><span class="p">.</span><span class="n">customlist</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'>          <span class="c1">//Create our adapter</span>
</span><span class='line'>          <span class="n">listAdapter</span> <span class="p">=</span> <span class="k">new</span> <span class="n">CustomListAdapter</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'>          <span class="c1">//Find the listview reference</span>
</span><span class='line'>          <span class="kt">var</span> <span class="n">listView</span> <span class="p">=</span> <span class="n">FindViewById</span><span class="p">&lt;</span><span class="n">ListView</span><span class="p">&gt;(</span><span class="n">Resource</span><span class="p">.</span><span class="n">id</span><span class="p">.</span><span class="n">listView</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'>          <span class="c1">//Hook up our adapter to our ListView</span>
</span><span class='line'>          <span class="n">listView</span><span class="p">.</span><span class="n">Adapter</span> <span class="p">=</span> <span class="n">listAdapter</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>          <span class="c1">//Wire up the click event</span>
</span><span class='line'>          <span class="n">listView</span><span class="p">.</span><span class="n">ItemClick</span> <span class="p">+=</span> <span class="k">new</span> <span class="n">EventHandler</span><span class="p">&lt;</span><span class="n">ItemEventArgs</span><span class="p">&gt;(</span><span class="n">listView_ItemClick</span><span class="p">);</span>
</span><span class='line'>      <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>      <span class="k">void</span> <span class="nf">listView_ItemClick</span><span class="p">(</span><span class="kt">object</span> <span class="n">sender</span><span class="p">,</span> <span class="n">ItemEventArgs</span> <span class="n">e</span><span class="p">)</span>
</span><span class='line'>      <span class="p">{</span>
</span><span class='line'>          <span class="c1">//Get our item from the list adapter</span>
</span><span class='line'>          <span class="kt">var</span> <span class="n">item</span> <span class="p">=</span> <span class="k">this</span><span class="p">.</span><span class="n">listAdapter</span><span class="p">.</span><span class="n">GetItemAtPosition</span><span class="p">(</span><span class="n">e</span><span class="p">.</span><span class="n">Position</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'>          <span class="c1">//Make a toast with the item name just to show it was clicked</span>
</span><span class='line'>          <span class="n">Toast</span><span class="p">.</span><span class="n">MakeText</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="n">item</span><span class="p">.</span><span class="n">Name</span> <span class="p">+</span> <span class="s">&quot; Clicked!&quot;</span><span class="p">,</span> <span class="n">ToastLength</span><span class="p">.</span><span class="n">Short</span><span class="p">).</span><span class="n">Show</span><span class="p">();</span>
</span><span class='line'>      <span class="p">}</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>Hereâ€™s the layout xml behind this activity:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
</pre></td><td class='code'><pre><code class='xml'><span class='line'><span class="cp">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span>
</span><span class='line'><span class="nt">&lt;LinearLayout</span>
</span><span class='line'><span class="na">android:id=</span><span class="s">&quot;@+id/widget28&quot;</span>
</span><span class='line'><span class="na">android:layout_width=</span><span class="s">&quot;fill_parent&quot;</span>
</span><span class='line'><span class="na">android:layout_height=</span><span class="s">&quot;fill_parent&quot;</span>
</span><span class='line'><span class="na">android:orientation=</span><span class="s">&quot;vertical&quot;</span>
</span><span class='line'><span class="na">xmlns:android=</span><span class="s">&quot;http://schemas.android.com/apk/res/android&quot;</span>
</span><span class='line'><span class="nt">&gt;</span>
</span><span class='line'>  <span class="nt">&lt;ListView</span>
</span><span class='line'>  <span class="na">android:id=</span><span class="s">&quot;@+id/listView&quot;</span>
</span><span class='line'>  <span class="na">android:layout_width=</span><span class="s">&quot;fill_parent&quot;</span>
</span><span class='line'>  <span class="na">android:layout_height=</span><span class="s">&quot;fill_parent&quot;</span>
</span><span class='line'><span class="nt">&gt;</span>
</span><span class='line'>
</span><span class='line'>  <span class="nt">&lt;/ListView&gt;</span>
</span><span class='line'><span class="nt">&lt;/LinearLayout&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<p>So you can see in my Activityâ€™s <em>OnCreate</em>, Iâ€™m calling the base method (important), and then setting the activityâ€™s content view to the layout xml that I showed you above. Iâ€™m also creating an instance of the <em>CustomListAdapter</em> I made earlier, and finding a reference to my ListView, so that I can set my <em>ListView</em>â€™s .<em>Adapter</em> property to the instance of the <em>CustomListAdapter</em>. As a bonus, I register the <em>ItemClick</em> event of my <em>ListView</em>, and in it, retrieve the item for the given position, from my <em>CustomListAdapter</em>, using the method I added to the adapter (<em>GetItemPositionAt</em>). I then display a Toast with the name of the Animal clicked.</p>

<p>Hopefully this little tutorial enlightens you on how to make some fancy lists (not those boring default ones). Iâ€™ve also made the source code of the entire project available:</p>

<p>http://goo.gl/AcGI</p>
]]></content>
  </entry>
  
</feed>
