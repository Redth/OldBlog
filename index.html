
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Redth</title>
  <meta name="author" content="Jon">

  
  <meta name="description" content="Google Play Services is a rapidly evolving library that Google has been using to combat fragmentation on the platform, and ensure their developers &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://redth.info">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/atom.xml" rel="alternate" title="Redth" type="application/atom+xml">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="./javascripts/lib/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-6465612-17']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">Redth</a></h1>
  
    <h2>code, ramblings, rants</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:redth.info" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div class="blog-index">
  
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/Xamarin-Google-Play-Services-Improvements">Improvements Coming to Xamarin Google Play Services</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2015-05-22T00:00:00-04:00" pubdate data-updated="true">May 22<span>nd</span>, 2015</time>
        
         | <a href="/Xamarin-Google-Play-Services-Improvements#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Google Play Services is a rapidly evolving library that Google has been using to combat fragmentation on the platform, and ensure their developers have access to great new API&#8217;s without having to worry about what Android version their users are actually on.</p>

<p>The rate at which this library has evolved recently has been especially challenging for us to keep pace with in getting bindings out for Xamarin.Android, but, rest assured, we are committed to bringing out a great Google Play Services experience in your Xamarin apps.  Here are some of the improvements we&#8217;ve been making that are now available as pre-release!</p>

<h2>Latest and Greatest</h2>

<p>Google has rapidly iterated in the last few revisions.  We went from 6.5 to 7.0 to 7.3 very quickly, and we&#8217;re happy to say we&#8217;re shipping the latest and greatest and expect to keep a better track record going forward on getting the latest out quickly!</p>

<p><strong>NOTE:</strong> As of this post, the improvements are available on NuGet as <strong><em>24.0.0-rc1</em></strong> versioned pacakges.</p>

<h2>NuGet what you Want</h2>

<p>We&#8217;ve now split up Google Play Services into many NuGet packages to match the changes Google made to split them up into many .jar files.  Using NuGet we&#8217;re able to manage the dependencies between all of the packages.  For example, all packages depend on the <em>Google Play Services - Base</em> package, while others such as <em>Location</em> depend on <em>Maps</em> as well.</p>

<p>You can now grab only the packages you need in your app without bringing in everything else.  This should help keep your app size down as Google continues to expand Play Services adding more and more features and API&#8217;s.</p>

<p>Finally, the old <em>Google Play Services - All</em> package has been kept around to help make the transition easier.  It now depends on all of the individual NuGet packages.</p>

<h2>Breaking Changes, Nicer Naming</h2>

<p>In the process of binding libraries to make them more C# friendly, we often run into cases where casing is different between java and C#.  For example, in java, we have <code>cast.Cast</code> which in C# translates into <code>Cast.Cast</code>.  Since we cannot have a class named the same as its namespace in C#, this presents a problem.  Traditionally we have renamed the class, for example to <code>Cast.CastClass</code>.  This isn&#8217;t always very discoverable or nice to look at.</p>

<p>We&#8217;ve now decided to change the namespaces instead of renaming the conflicting classes.  All namespaces now have <em>Sdk</em> appended to them, so we now have <code>CastSdk.Cast</code> for instance.  This should be much more consistent and discoverable going foward.</p>

<p>The other area where this is a problem is with fields in java.  For instance, <code>Fitness.FITNESS_API</code> and <code>Fitness.FitnessApi</code> in java both transform into <code>Fitness.FitnessApi</code> in a C# binding by default.  To avoid conflicts and bring consistency across the bindings, we&#8217;ve decided to keep the java naming conventions in the C# binding.</p>

<p>You&#8217;ll now use the upper-cased <code>Fitness.FITNESS_API</code> fields to specify an Api to add in your <code>IGoogleApiClient.AddApi (..)</code> calls, whereas you&#8217;ll use the lower-cased <code>Fitness.FitnessApi</code> fields to actually invoke methods of the given Api.</p>

<h2>Happier C# Developers</h2>

<p>Our binding tooling generally does a good job at making java libraries more C#-ified.  Google Play Services has a number of cases that are less friendly to our tooling and often this has created a sub-par developer experience from a C# perspective.</p>

<p>We&#8217;re continuing to work at improving this story in Google Play Services, and there are a couple of changes that should make life better:</p>

<h3>IPendingResult.AsAsync</h3>

<p>A very common pattern in Google Play Services is to make use of the interface <code>IPendingResult</code>.  This is sort of like a <code>Task</code> - it&#8217;s a promise or a future.  You can <code>.Await()</code> it in a blocking manner (though you must do so off the UI thread), or you can <code>.SetResultCallback (IResultCallback)</code> which means you need to pass in an implementation of the interface which usually means creating an implementor class with some Actions or Events to make the code a bit less ugly (since we don&#8217;t have anonymous classes in C#).</p>

<p>You now have more options with <code>IPendingIntent</code> instances through some extension methods:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class='csharp'><span class='line'><span class="c1">// 1. Turn it into a Task with the desired result type</span>
</span><span class='line'><span class="kt">var</span> <span class="n">result</span> <span class="p">=</span> <span class="k">await</span> <span class="n">SomeMethodReturningPendingIntent</span> <span class="p">(...)</span>
</span><span class='line'>  <span class="p">.</span><span class="n">AsAsync</span><span class="p">&lt;</span><span class="n">TypeOfStatus</span><span class="p">&gt;</span> <span class="p">()</span>
</span><span class='line'>
</span><span class='line'><span class="c1">// 2. Pass in an Action&lt;T&gt; to the callback</span>
</span><span class='line'><span class="n">SomeMethodReturningPendingIntent</span> <span class="p">(...)</span>
</span><span class='line'>  <span class="p">.</span><span class="n">SetResultCallback</span><span class="p">&lt;</span><span class="n">TypeOfStatus</span><span class="p">&gt;</span> <span class="p">(</span><span class="n">result</span> <span class="p">=&gt;</span> <span class="p">{</span>
</span><span class='line'>      <span class="c1">// ...</span>
</span><span class='line'>  <span class="p">});</span>
</span></code></pre></td></tr></table></div></figure>


<h3>Helper Implementor Classes</h3>

<p>There&#8217;s still a lot of areas that require you pass in some sort of class implementing a listener type of interface.  <code>ILocationListener</code> is a good example.  Instead of having to build your own class which implements this simple interface, we&#8217;ve added a class <code>LocationListener</code> which implements <code>ILocationListener</code> and exposes an event for you.  Nothing earth-shattering here, but hopefully it saves you from writing the same boiler plate code over and over.</p>

<p>You can expect more implementation classes like this going forward.</p>

<h3>GoogleApiClientBuilder</h3>

<p>The first place you&#8217;ll probably notice the heavy use of interfaces is in the <code>GoogleApiClientBuilder</code>.  The <code>.AddConnectionCallbacks (..)</code> and <code>.AddOnConnectionFailedListener (..)</code> methods both require instances of interface implementations as parameters.  You can still call these methods like normal, but now there&#8217;s extension methods allowing you to pass Action&#8217;s into them as appropriate.  Again, this is code you could easily write, but shouldn&#8217;t have to.</p>

<h3>Less p0, p1, p2</h3>

<p>This has always been a bit of an eye-sore, to see poorly named parameters.  We&#8217;ve made some improvements in our tooling that are going to continue to help get better parameter names.  We&#8217;ve started trying some of these techniques out already in Google Play Services!</p>

<h2>Feedback?</h2>

<p>I don&#8217;t always get to explore all of the API&#8217;s inside Google Play Services on a day to day basis, so I&#8217;m not always aware of where the pain points are.</p>

<p>I&#8217;m very open to feedback if there&#8217;s other areas you&#8217;d like to see some C# improvements to like we&#8217;ve started.</p>

<p>Please don&#8217;t be shy, mention me on twitter with any suggestions you have!</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/Xamarin-Studio-Launcher-v3">New and Improved Xamarin Studio Launcher</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2015-01-12T00:00:00-05:00" pubdate data-updated="true">Jan 12<span>th</span>, 2015</time>
        
         | <a href="/Xamarin-Studio-Launcher-v3#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p><strong>UPDATE - Jan 12, 2015:</strong> Thanks to the wonderful <a href="http://twitter.com/vancura">@Vaclav</a>, Xamarin Studio Launcher now has a proper icon!  Please download the much prettier v4 at the end of this post!</p>

<p>Awhile back I made a quick little AppleScript based app called <a href="/Xamarin-Studio-Launcher/">Xamarin Studio Launcher</a> to help launch multiple instances of Xamarin Studio (it had a pretty little icon that you could keep in your dock to open new instances - which I recently updated to the newer Xamarin look).</p>

<p><img src="/images/Xamarin-Studio-Launcher/Xamarin.Studio.Launcher.Icon.png" alt="Xamarin Studio Launcher" /></p>

<p>While it was cute, and relatively functional, as a recovering ex-Windows user, I found myself still constantly opening <code>.sln</code> files from finder, which would cause them to open in an existing instance of Xamarin Studio, closing whatever current solution happened to be open in that instance.</p>

<p>Now I know about the ability to open multiple solutions in the same Xamarin Studio instance, and generally I&#8217;m pretty good about forcing myself into learning the nuances of the platform I&#8217;m working on, however, having multiple instances of Visual Studio open was something I grew so accustomed to that I just couldn&#8217;t shake the habit of being on a Mac!</p>

<p>Not sure why it took me so long to make this, but here it is, finally!</p>

<h3>Xamarin Studio Launcher v3</h3>

<p>This new launcher app works first and foremost exactly like the <a href="/Xamarin-Studio-Launcher/">previous Xamarin Studio Launcher</a> I released.  You can put it in your dock, and when you open it, it will launch a new, blank instance of Xamarin Studio.</p>

<p><em>The new feature</em> is that it can now handle opening <code>.sln</code> files.  If you choose to open a <code>.sln</code> file with this app, it will open that <code>.sln</code> file in a <em>new</em> instance of Xamarin Studio.</p>

<p>This means you can set Finder to open all <code>.sln</code> files with Xamarin Studio Launcher so any time you double click or otherwise open a <code>.sln</code> file from Finder, it will open in its own instance of Xamarin Studio!</p>

<p><strong>How to set this as the default app for .sln files</strong></p>

<p><img src="/images/Xamarin-Studio-Launcher/Finder.Info.ChangeAll.png" alt="Xamarin Studio Launcher" /></p>

<ol>
<li>Find a <code>.sln</code> file in Finder</li>
<li>Right click the <code>.sln</code> file and <code>Get Info</code> (or highlight the file and <code>cmd + i</code></li>
<li>Under the <em>Open With</em> section, click the drop-down list and click <em>Choose</em></li>
<li>Navigate to and select <em>Xamarin Studio Launcher</em></li>
<li>Click <em>Change All</em></li>
</ol>


<p><strong>Download</strong></p>

<p>Here&#8217;s the .zip file containing <em>Xamarin Studio Launcher.app</em>:</p>

<p><a href="/assets/Xamarin.Studio.Launcher.v4.zip">Download Xamarin Studio Launcher v4</a></p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/smarter-android-support-v4-v13-packages">Smarter Xamarin Android Support V4 / V13 Packages</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2014-09-17T00:00:00-04:00" pubdate data-updated="true">Sep 17<span>th</span>, 2014</time>
        
         | <a href="/smarter-android-support-v4-v13-packages#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>If you&#8217;ve ever built an Android app, you&#8217;ve probably used the Android Support libraries.  Google created these as a way to enable developers to use new features on older Android versions.  The most common Support library is arguably <code>Support-v4</code>, however as older Android devices retire and newer versions of Android increase in market share, <code>Support-v13</code> is becoming more commonplace.</p>

<p><strong><em>Warning:</em></strong> This is going to be a bit geeky of a post.  If you don&#8217;t want to know the details, skip down to the <strong>TL;DR</strong> section for the need-to-know bits :)</p>

</div>
  
  
    <footer>
      <a rel="full-article" href="/smarter-android-support-v4-v13-packages">Read on &rarr;</a>
    </footer>
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/unifying-google-play-services">Unifying Google Play Services</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2014-09-16T00:00:00-04:00" pubdate data-updated="true">Sep 16<span>th</span>, 2014</time>
        
         | <a href="/unifying-google-play-services#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Once upon a time, you may have noticed there were a lot of choices when it came to adding Google Play Services to your Xamarin.Android apps.</p>

<p><img src="/images/unifying-google-play-services/xamarin-google-play-services-components.png" alt="Google Play Services Chaos" /></p>

</div>
  
  
    <footer>
      <a rel="full-article" href="/unifying-google-play-services">Read on &rarr;</a>
    </footer>
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/android-keystore-signatures-md5-sha1">Finding Your Android App&#8217;s MD5 or SHA1 Signature From Your Keystore</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2014-06-20T00:00:00-04:00" pubdate data-updated="true">Jun 20<span>th</span>, 2014</time>
        
         | <a href="/android-keystore-signatures-md5-sha1#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p><img style="float: right" src="/images/android-keystore-signatures-md5-sha1/keystore-grumpy-cat.jpg" /></p>

<p>If you&#8217;ve ever used Google Maps or Amazon App Services in your Android app, you&#8217;ve probably gone through the pain of having to find an MD5 or SHA1 signature to give to the service so they could generate an API Key for you.</p>

<p>If you haven&#8217;t been through this experience, let me assure you: It&#8217;s painful, tedious, and annoying.</p>

</div>
  
  
    <footer>
      <a rel="full-article" href="/android-keystore-signatures-md5-sha1">Read on &rarr;</a>
    </footer>
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/what-are-app-links">What Are App Links?</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2014-05-08T00:00:00-04:00" pubdate data-updated="true">May 8<span>th</span>, 2014</time>
        
         | <a href="/what-are-app-links#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p><img style="float: right" src="/images/App-Links/App-Links.png" /></p>

<p>So there&#8217;s this new thing called App Links.  It&#8217;s backed by Facebook and some other big names, so you know it&#8217;s going to gain at least a bit of traction.  But the problem is, everyone seems to have a hard time figuring out what they actually are and do.  The video on AppLinks.org sort of helps, but it still left me confused, even after watching it a few times.</p>

<p>Here&#8217;s my attempt to explain what App Links are, why you would need or want them, and how they work.  A word of caution: this post is aimed at mobile app developers, so it may be a bit confusing if you&#8217;re not familiar with some of the concepts of mobile app development.</p>

</div>
  
  
    <footer>
      <a rel="full-article" href="/what-are-app-links">Read on &rarr;</a>
    </footer>
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/such-android-api-levels-much-confuse-wow">Such Android API Levels, Much Confuse. Wow.</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2014-04-29T00:00:00-04:00" pubdate data-updated="true">Apr 29<span>th</span>, 2014</time>
        
         | <a href="/such-android-api-levels-much-confuse-wow#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p><img style="float: right" src="/images/Android-API-Levels/Doge-API-Level.png" /></p>

<p>I have been bitten more than once by the confusion of Android&#8217;s many API levels when building Xamarin.Android apps.  It gets even more complex when you start referencing other libraries that target different API levels.  Just the other day I had an <a href="https://github.com/Redth/AndHUD/issues/9">issue come up with AndHUD</a> where the resolution for a runtime error had nothing to do with the code itself.  I decided it was time to finally write this post.</p>

<p>As if it weren&#8217;t confusing enough, Google generally gives three names to every API level: an integer API Level number, a version number, and a delicious sounding dessert name.</p>

<p>For example, Gingerbread was version 2.3 or API Level 9 (also Gingerbread had 2.3.7 and API level 10 as an update).  Kit Kat is version 4.4, API level 19.  Luckily <a href="http://developer.android.com/guide/topics/manifest/uses-sdk-element.html">Google has published</a> the various versions in a table so you can figure out what is what.</p>

<p>When it comes to your Xamarin.Android apps, it&#8217;s important to be aware of all of the spots you can set API levels in your project settings.  In particular, there are three places of interest:</p>

<ol>
<li>Project Settings -> General -> Target Framework</li>
<li>Project Settings -> Android Application -> Minimum Android Version</li>
<li>Project Settings -> Android Application -> Target Android Version</li>
</ol>


</div>
  
  
    <footer>
      <a rel="full-article" href="/such-android-api-levels-much-confuse-wow">Read on &rarr;</a>
    </footer>
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/itunes-media-hotkey-disabler">iTunes Media HotKey Disabler</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2013-11-27T00:00:00-05:00" pubdate data-updated="true">Nov 27<span>th</span>, 2013</time>
        
         | <a href="/itunes-media-hotkey-disabler#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>This simple application will allow you to disable or enable iTunes from listening to when you press the media keys (Play / Pause) on your keyboard.  This is great for applications such as gTunes which make use of the hot keys but cannot themselves prevent iTunes from also responding to those keyboard keys.</p>

<p><img src="/images/itunes-media-hotkey-disabler/itunes-media-hotkey-disabler.png" alt="" /></p>

</div>
  
  
    <footer>
      <a rel="full-article" href="/itunes-media-hotkey-disabler">Read on &rarr;</a>
    </footer>
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/ios7-full-screen-layout">iOS7: Fun Times With the New Full Screen Layout!</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2013-09-26T00:00:00-04:00" pubdate data-updated="true">Sep 26<span>th</span>, 2013</time>
        
         | <a href="/ios7-full-screen-layout#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>In a mad rush, I had to prepare an app for iOS7 <em>after</em> its release.  Yes, I know, shame on me for not listening to everyone telling me to start getting my apps ready early.  How bad could it be anyway?</p>

<p>For the most part, not too bad.  The worst part for me came in the shape of dealing with this new idea that every <code>UIViewController</code> now expands the bounds of the entire screen, including where the status bar and navigation bars could be.  In any case, I had to do a bit of learning really quickly.  If you don&#8217;t already know what I&#8217;m talking about, here&#8217;s a picture of one unpleasant conversion experience:</p>

<p><img src="/images/ios7-full-screen-layout/navigation-bar-overlapping.png" alt="" /></p>

</div>
  
  
    <footer>
      <a rel="full-article" href="/ios7-full-screen-layout">Read on &rarr;</a>
    </footer>
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/ios7-recipe-background-fetching">iOS7 Recipe: Background Fetching</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2013-09-22T00:00:00-04:00" pubdate data-updated="true">Sep 22<span>nd</span>, 2013</time>
        
         | <a href="/ios7-recipe-background-fetching#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>This is my entry into the <a href="http://blog.xamarin.com/xamarin-recipe-cook-off/">Xamarin Recipe Cook-Off</a>.  Recipes, in Xamarin terms, are very simple demonstrations of how a single feature or piece of functionality is implemented.  I thought background fetching would be useful to many developers, and it&#8217;s pretty easy to implement, especially after reading this recipe.</p>

<ul>
<li><a href="https://github.com/Redth/iOS.BackgroundFetch.Sample">View the entire Recipe &amp; Source Code</a></li>
</ul>


<p>I&#8217;ve also included the recipe in this blog post:</p>

<h2>Background Fetching Data</h2>

<p>This recipe shows how to register your application to perform background fetching on intervals.</p>

<h4>1. Recipe</h4>

<p>In your application&#8217;s <code>Info.plist</code> file, add the value <code>fetch</code> to the <code>UIBackgroundModes</code> (<em>Required background modes</em>) property.</p>

<p>Next, in your <code>AppDelegate</code> class, in the <code>FinishedLaunching</code> override method, add the following code to register your application for background fetching:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='csharp'><span class='line'><span class="n">UIApplication</span><span class="p">.</span><span class="n">SharedApplication</span><span class="p">.</span><span class="n">SetMinimumBackgroundFetchInterval</span> <span class="p">(</span><span class="n">UIApplication</span><span class="p">.</span><span class="n">BackgroundFetchIntervalMinimum</span><span class="p">);</span>
</span></code></pre></td></tr></table></div></figure>


<p>Finally, in your <code>AppDelegate</code> class, override the <code>PerformFetch</code> method.</p>

<p>This method will be executed by the operating system when it sees best fit (eg: when the device is awake and connected already).  You do not have complete control over how often or when fetching happens.</p>

<p>You should execute your own code to fetch new data in this method.  It&#8217;s important to call the <code>Action&lt;UIBackgroundFetchResult&gt; completionHandler</code> parameter which is passed into this method with the appropriate result when you are done.</p>

<h4>2. Sample PerformFetch</h4>

<p>In this sample, a weather service is called by background fetching so that when the user opens the app, recent weather is available.  The weather is cached locally after it&#8217;s fetched in the background, and the UI is also updated if there is new weather info.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
</pre></td><td class='code'><pre><code class='csharp'><span class='line'><span class="k">public</span> <span class="k">override</span> <span class="k">async</span> <span class="k">void</span> <span class="nf">PerformFetch</span> <span class="p">(</span><span class="n">UIApplication</span> <span class="n">application</span><span class="p">,</span> <span class="n">Action</span><span class="p">&lt;</span><span class="n">UIBackgroundFetchResult</span><span class="p">&gt;</span> <span class="n">completionHandler</span><span class="p">)</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>  <span class="n">Console</span><span class="p">.</span><span class="n">WriteLine</span> <span class="p">(</span><span class="s">&quot;PerformFetch called...&quot;</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'>  <span class="c1">//Return no new data by default</span>
</span><span class='line'>  <span class="kt">var</span> <span class="n">result</span> <span class="p">=</span> <span class="n">UIBackgroundFetchResult</span><span class="p">.</span><span class="n">NoData</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">try</span>
</span><span class='line'>  <span class="p">{</span>
</span><span class='line'>    <span class="c1">//Get latest weather</span>
</span><span class='line'>    <span class="kt">var</span> <span class="n">w</span> <span class="p">=</span> <span class="k">await</span> <span class="n">GetWeatherAsync</span><span class="p">(</span><span class="s">&quot;Windsor, Canada&quot;</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">if</span> <span class="p">(</span><span class="n">w</span> <span class="p">!=</span> <span class="k">null</span><span class="p">)</span>
</span><span class='line'>    <span class="p">{</span>
</span><span class='line'>      <span class="c1">//Cache the weather locally</span>
</span><span class='line'>      <span class="n">CacheWeatherAsync</span><span class="p">(</span><span class="n">w</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'>      <span class="c1">//Update the UI</span>
</span><span class='line'>      <span class="n">weatherViewController</span><span class="p">.</span><span class="n">UpdateWeather</span><span class="p">(</span><span class="n">w</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'>      <span class="c1">//Indicate we have new data</span>
</span><span class='line'>      <span class="n">result</span> <span class="p">=</span> <span class="n">UIBackgroundFetchResult</span><span class="p">.</span><span class="n">NewData</span><span class="p">;</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'>  <span class="k">catch</span>
</span><span class='line'>  <span class="p">{</span>
</span><span class='line'>    <span class="c1">//Indicate a failed fetch if there was an exception</span>
</span><span class='line'>    <span class="n">result</span> <span class="p">=</span> <span class="n">UIBackgroundFetchResult</span><span class="p">.</span><span class="n">Failed</span><span class="p">;</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'>  <span class="k">finally</span>
</span><span class='line'>  <span class="p">{</span>
</span><span class='line'>    <span class="c1">//We really should call the completion handler with our result</span>
</span><span class='line'>    <span class="n">completionHandler</span> <span class="p">(</span><span class="n">result</span><span class="p">);</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<h4>3. Additional Information</h4>

<ul>
<li>Your <code>PerformFetch</code> has about <strong>30</strong> seconds to run before it&#8217;s killed</li>
<li>The operating system is more likely to grant more time (and more often) to your application for background fetching if you are efficient, which means executing quickly, and always calling <code>completionHandler</code> with an accurate result</li>
<li>You can tell the operating system  the minimum time to sleep between waking up your application and calling its <code>PerformFetch</code> method if you know your app only updates at a certain interval, to avoid extra calls to <code>PerformFetch</code> and wasting battery life.  You would specify the minimum time in seconds in the <code>UIApplication.SharedApplication.SetMinimumBackgroundFetchInterval (double minimumBackgroundFetchInterval)</code> method</li>
<li>You can actually make calls to update your UI from the <code>PerformFetch</code> method so that the next time the user launches the app, everything is up to date</li>
</ul>

</div>
  
  


    </article>
  
  <div class="pagination">
    
      <a class="prev" href="/blog/page/2/">&larr; Older</a>
    
    <a href="/blog/archives">Blog Archives</a>
    
  </div>
</div>
<aside class="sidebar">
  
    <section>
  	<br />
  	<p><img src="/images/Site/Redth.png" alt="Redth" /></p>
  
  	<p>
   	 <a href="http://www.amazon.com/gp/product/1118026438/ref=as_li_tf_il?ie=UTF8&camp=1789&creative=9325&creativeASIN=1118026438&linkCode=as2&tag=red082-20"><img border="0" src="http://ws-na.amazon-adsystem.com/widgets/q?_encoding=UTF8&ASIN=1118026438&Format=_SL160_&ID=AsinImage&MarketPlace=US&ServiceVersion=20070822&WS=1&tag=red082-20" ></a><img src="http://ir-na.amazon-adsystem.com/e/ir?t=red082-20&l=as2&o=1&a=1118026438" width="1" height="1" border="0" alt="" style="border:none !important; margin:0px !important;" />

     </p>

     <p><a href="http://gonemobile.io" target="_blank"><img src="/images/Site/Gone-Mobile-Podcast.png" alt="Gone Mobile Podcast" title="Gone Mobile Podcast" /></a></p>

     <p><a href="http://planet.xamarin.com" target="_blank"><img src="/images/Site/Xamarin-Planet-Badge.png" alt="Featured Xamarin Planet Community Blog" title="Featured Xamarin Planet Community Blog" /></a></p>

     <p> 
      <iframe src="http://githubbadge.appspot.com/badge/Redth?a=0" style="border: 0;height: 108px;width: 200px;overflow: hidden;" frameBorder=0></iframe>     
     </p>
     
     <p>
      <a href="http://ca.linkedin.com/pub/jonathan-dick/3/a60/2b5"><img src="http://www.linkedin.com/img/webpromo/btn_viewmy_160x33.png" width="160" height="33" border="0" alt="View Jonathan Dick's profile on LinkedIn"></a>
      </p>


      <table cellpadding="0" cellspacing="0">
        <tr>
          <td>
            <a href="http://xamarin.com/mvp" target="_blank" style="border-style: none;"><img src="/images/Site/Xamarin-MVP-Badge.png" alt="Xamarin Most Valuable Professional" /></a>
          </td>
          <td>
            <a href="http://xamarin.com/consulting-partners" target="_blank" style="border-style: none;"><img src="/images/Site/Xamarin-Certified-Developer.png" alt="Xamarin Certified Developer" /></a>
          </td>         
        </tr>
      </table>
      <br />
      

      <a class="twitter-timeline" data-dnt=true href="https://twitter.com/redth" data-widget-id="253917988271562752">Tweets by @redth</a>
      <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src="//platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script>

</section>
<section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/Xamarin-Google-Play-Services-Improvements">Improvements coming to Xamarin Google Play Services</a>
      </li>
    
      <li class="post">
        <a href="/Xamarin-Studio-Launcher-v3">New and Improved Xamarin Studio Launcher</a>
      </li>
    
      <li class="post">
        <a href="/smarter-android-support-v4-v13-packages">Smarter Xamarin Android Support v4 / v13 Packages</a>
      </li>
    
      <li class="post">
        <a href="/unifying-google-play-services">Unifying Google Play Services</a>
      </li>
    
      <li class="post">
        <a href="/android-keystore-signatures-md5-sha1">Finding your Android app&#8217;s MD5 or SHA1 Signature from your keystore</a>
      </li>
    
  </ul>
</section>





  
</aside>

    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2015 - Jon -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  

<script type="text/javascript">
      var disqus_shortname = 'redth';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'http://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>



<div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) {return;}
  js = d.createElement(s); js.id = id; js.async = true;
  js.src = "//connect.facebook.net/en_US/all.js#appId=212934732101925&xfbml=1";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>





  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = 'http://platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
