
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Using the Android Contact Picker with Xamarin.Mobile to Send an SMS in Mono for Android 4.0 - Redth</title>
  <meta name="author" content="Jon">

  
  <meta name="description" content="First and foremost: Xamarin has been doing an awesome job with their MonoTouch and Mono for Android product line! Huge kudos to the entire team for &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://Redth.github.io/Blog/using-the-android-contact-picker-with-xamarin">
  <link href="/Blog/favicon.png" rel="icon">
  <link href="/Blog/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/Blog/atom.xml" rel="alternate" title="Redth" type="application/atom+xml">
  <script src="/Blog/javascripts/modernizr-2.0.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="./javascripts/lib/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/Blog/javascripts/octopress.js" type="text/javascript"></script>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  

</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/Blog/">Redth</a></h1>
  
    <h2>code, ramblings, and other fun activities</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/Blog/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:Redth.github.io/Blog" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/Blog/">Blog</a></li>
  <li><a href="/Blog/blog/archives">Archives</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div>
<article class="hentry" role="article">
  
  <header>
    
      <h1 class="entry-title">Using the Android Contact Picker With Xamarin.Mobile to Send an SMS in Mono for Android 4.0</h1>
    
    
      <p class="meta">
        








  


<time datetime="2011-12-08T00:00:00-05:00" pubdate data-updated="true">Dec 8<span>th</span>, 2011</time>
        
      </p>
    
  </header>


<div class="entry-content"><p>First and foremost: Xamarin has been doing an awesome job with their MonoTouch and Mono for Android product line!  Huge kudos to the entire team for allowing us some much needed obj-c and java mobile platform escapism!</p>

<p>If you don&#8217;t know about Xamarin, they are the company behind products allowing developers to write TRUELY NATIVE applications for Android and iOS in C#!  I honestly can&#8217;t say enough good things about these products, but you should check them out for yourself: http://xamarin.com</p>

<p>Onto the goodies.  If it wasn&#8217;t enough for us to be able to access native iOS and Android API&#8217;s via C#, Xamarin has gone ahead and started building a cross mobile platform set of libraries which aim to help us developers even more in creating sets of code to be reused on all the great mobile platforms.  You can check out more about this initiative here: http://blog.xamarin.com/2011/11/22/introducing-the-xamarin-mobile-api/</p>

<p>The latest preview version of Xamarin.Mobile just hit the intertubes, and I was keen to try it out as a replacement to some awful code I had to write to deal with the Android API&#8217;s for Contacts.  This latest preview now contains Contacts and Location API support for both MonoTouch and Mono for Android.  In the sample below, you can see some Android specific code, so I&#8217;m not truely writing cross platform code here, but with a bit of abstraction from the UI layer, this would be possible.  However, the purpose of this example is more to show you just how bleeping easy it is to work with Contacts in Mono for Android using Xamarin.Mobile!</p>

<p>It&#8217;s so simple I don&#8217;t even think it needs any explanation past the comments in the code I&#8217;ve provided!  Enjoy!</p>

<p>PS - A special thanks to @ermau who has been hard at work creating Xamarin.Mobile, and has been super helpful (how cliche of Xamarin folks!) in using it!</p>

<p>~~~~{.csharp}
void button_Click(object sender, EventArgs e)
{</p>

<pre><code>//Create a new intent for choosing a contact
var contactPickerIntent = new Intent(Intent.ActionPick,
    Android.Provider.ContactsContract.Contacts.ContentUri);

//Start the contact picker expecting a result
// with the resultCode '101'
StartActivityForResult(contactPickerIntent, 101);
</code></pre>

<p>}
~~~~</p>

<p>~~~~{.csharp}
public override void OnActivityResult(int requestCode, Result resultCode, Intent data)
{</p>

<pre><code>//See if we are handling the contact picker request code
//  and that the result code is ok!
if (requestCode == 101 &amp;&amp; resultCode == Result.Ok)
{
    //Ensure we have data returned
    if (data == null || data.Data == null)
        return;

    //Xamarin.Mobile code here :)
    var addressBook = new Xamarin.Contacts.AddressBook(this);
    //Note: This is important 
    addressBook.PreferContactAggregation = true;

    //Load the contact via the android contact id
    // in the last segment of the Uri returned by the 
    // android contact picker
    var contact = addressBook.Load(data.Data.LastPathSegment);

    //Use linq to find a mobile number
    var mobile = (from p in contact.Phones where 
                    p.Type == Xamarin.Contacts.PhoneType.Mobile
                    select p.Number).FirstOrDefault();

    //See if the contact has a mobile number
    if (string.IsNullOrEmpty(mobile))
    {
        Toast.MakeText(this, "No Mobile Number for contact!", 
            ToastLength.Short).Show();
        return;
    }

    //Send SMS!
    var smsMgr = Android.Telephony.SmsManager.Default;

    smsMgr.SendTextMessage(mobile, null, "Hello World!", null, null);
}
</code></pre>

<p>}
~~~~</p>
</div>


  <footer>
    <p class="meta">
      
  

<span class="byline author vcard">Posted by <span class="fn">Jon</span></span>

      








  


<time datetime="2011-12-08T00:00:00-05:00" pubdate data-updated="true">Dec 8<span>th</span>, 2011</time>
      


    </p>
    
      <div class="sharing">
  
  <a href="http://twitter.com/share" class="twitter-share-button" data-url="http://Redth.github.io/Blog/using-the-android-contact-picker-with-xamarin" data-via="" data-counturl="http://Redth.github.io/Blog/using-the-android-contact-picker-with-xamarin" >Tweet</a>
  
  
  
</div>

    
    <p class="meta">
      
        <a class="basic-alignment left" href="/Blog/why-we-needed-facebook-messenger" title="Previous Post: Why we needed Facebook Messenger">&laquo; Why we needed Facebook Messenger</a>
      
      
        <a class="basic-alignment right" href="/Blog/the-problem-with-apples-push-notification-ser" title="Next Post: The problem with Apples Push Notification Service... Solutions and Workarounds...">The problem with Apples Push Notification Service... Solutions and Workarounds... &raquo;</a>
      
    </p>
  </footer>
</article>

</div>

<aside class="sidebar">
  
    <section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/Blog/xamarin-evolve-2013">Xamarin Evolve 2013</a>
      </li>
    
      <li class="post">
        <a href="/Blog/month-with-android">A Month With Android</a>
      </li>
    
      <li class="post">
        <a href="/Blog/why-i-am-looking-forward-to-android">Why I'm Looking forward to Android</a>
      </li>
    
      <li class="post">
        <a href="/Blog/get-your-monotouch-apps-ready-for-iphone-5-today">Get your MonoTouch apps ready for iPhone 5 / iOS 6 today!</a>
      </li>
    
      <li class="post">
        <a href="/Blog/the-problem-with-apples-push-notification-ser">The problem with Apples Push Notification Service... Solutions and Workarounds...</a>
      </li>
    
  </ul>
</section>





  
</aside>


    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2013 - Jon -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  







  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = 'http://platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
